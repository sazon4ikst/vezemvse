!function(a){"use strict";function b(a,b){for(var c=0;c<a.length;++c)b(a[c],c)}function c(b,c){this.$select=a(b),this.$select.attr("data-placeholder")&&(c.nonSelectedText=this.$select.data("placeholder")),this.options=this.mergeOptions(a.extend({},c,this.$select.data())),this.originalOptions=this.$select.clone()[0].options,this.query="",this.searchTimeout=null,this.lastToggledInput=null,this.options.multiple="multiple"===this.$select.attr("multiple"),this.options.onChange=a.proxy(this.options.onChange,this),this.options.onDropdownShow=a.proxy(this.options.onDropdownShow,this),this.options.onDropdownHide=a.proxy(this.options.onDropdownHide,this),this.options.onDropdownShown=a.proxy(this.options.onDropdownShown,this),this.options.onDropdownHidden=a.proxy(this.options.onDropdownHidden,this),this.options.onInitialized=a.proxy(this.options.onInitialized,this),this.buildContainer(),this.buildButton(),this.buildDropdown(),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(!0),this.options.disableIfEmpty&&a("option",this.$select).length<=0&&this.disable(),this.$select.hide().after(this.$container),this.options.onInitialized(this.$select,this.$container)}"undefined"!=typeof ko&&ko.bindingHandlers&&!ko.bindingHandlers.multiselect&&(ko.bindingHandlers.multiselect={after:["options","value","selectedOptions","enable","disable"],init:function(b,c,d,e,f){var g=a(b),h=ko.toJS(c());if(g.multiselect(h),d.has("options")){var i=d.get("options");ko.isObservable(i)&&ko.computed({read:function(){i(),setTimeout(function(){var a=g.data("multiselect");a&&a.updateOriginalOptions(),g.multiselect("rebuild")},1)},disposeWhenNodeIsRemoved:b})}if(d.has("value")){var j=d.get("value");ko.isObservable(j)&&ko.computed({read:function(){j(),setTimeout(function(){g.multiselect("refresh")},1)},disposeWhenNodeIsRemoved:b}).extend({rateLimit:100,notifyWhenChangesStop:!0})}if(d.has("selectedOptions")){var k=d.get("selectedOptions");ko.isObservable(k)&&ko.computed({read:function(){k(),setTimeout(function(){g.multiselect("refresh")},1)},disposeWhenNodeIsRemoved:b}).extend({rateLimit:100,notifyWhenChangesStop:!0})}var l=function(a){setTimeout(function(){a?g.multiselect("enable"):g.multiselect("disable")})};if(d.has("enable")){var m=d.get("enable");ko.isObservable(m)?ko.computed({read:function(){l(m())},disposeWhenNodeIsRemoved:b}).extend({rateLimit:100,notifyWhenChangesStop:!0}):l(m)}if(d.has("disable")){var n=d.get("disable");ko.isObservable(n)?ko.computed({read:function(){l(!n())},disposeWhenNodeIsRemoved:b}).extend({rateLimit:100,notifyWhenChangesStop:!0}):l(!n)}ko.utils.domNodeDisposal.addDisposeCallback(b,function(){g.multiselect("destroy")})},update:function(b,c,d,e,f){var g=a(b),h=ko.toJS(c());g.multiselect("setOptions",h),g.multiselect("rebuild")}}),c.prototype={defaults:{buttonText:function(b,c){if(this.disabledText.length>0&&(this.disableIfEmpty||c.prop("disabled"))&&0==b.length)return this.disabledText;if(0===b.length)return this.nonSelectedText;if(this.allSelectedText&&b.length===a("option",a(c)).length&&1!==a("option",a(c)).length&&this.multiple)return this.selectAllNumber?this.allSelectedText+" ("+b.length+")":this.allSelectedText;if(b.length>this.numberDisplayed)return b.length+" "+this.nSelectedText;var d="",e=this.delimiterText;return b.each(function(){var b=void 0!==a(this).attr("label")?a(this).attr("label"):a(this).text();d+=b+e}),d.substr(0,d.length-2)},buttonTitle:function(b,c){if(0===b.length)return this.nonSelectedText;var d="",e=this.delimiterText;return b.each(function(){var b=void 0!==a(this).attr("label")?a(this).attr("label"):a(this).text();d+=b+e}),d.substr(0,d.length-2)},optionLabel:function(b){return a(b).attr("label")||a(b).text()},optionClass:function(b){return a(b).attr("class")||""},onChange:function(a,b){},onDropdownShow:function(a){},onDropdownHide:function(a){},onDropdownShown:function(a){},onDropdownHidden:function(a){},onSelectAll:function(a){},onInitialized:function(a,b){},enableHTML:!1,buttonClass:"btn btn-default",inheritClass:!1,buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',dropRight:!1,dropUp:!1,selectedClass:"active",maxHeight:!1,checkboxName:!1,includeSelectAllOption:!1,includeSelectAllIfMoreThan:0,selectAllText:" Select all",selectAllValue:"multiselect-all",selectAllName:!1,selectAllNumber:!0,selectAllJustVisible:!0,enableFiltering:!1,enableCaseInsensitiveFiltering:!1,enableFullValueFiltering:!1,enableClickableOptGroups:!1,enableCollapsibelOptGroups:!1,filterPlaceholder:"Search",filterBehavior:"text",includeFilterClearBtn:!0,preventInputChangeEvent:!1,nonSelectedText:"None selected",nSelectedText:"selected",allSelectedText:"All selected",numberDisplayed:3,disableIfEmpty:!1,disabledText:"",delimiterText:", ",templates:{button:'<button type="button" class="multiselect dropdown-toggle" data-toggle="dropdown"><span class="multiselect-selected-text"></span> <b class="caret"></b></button>',ul:'<ul class="multiselect-container dropdown-menu"></ul>',filter:'<li class="multiselect-item filter"><div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text"></div></li>',filterClearBtn:'<span class="input-group-btn"><button class="btn btn-default multiselect-clear-filter" type="button"><i class="glyphicon glyphicon-remove-circle"></i></button></span>',li:'<li><a tabindex="0"><label></label></a></li>',divider:'<li class="multiselect-item divider"></li>',liGroup:'<li class="multiselect-item multiselect-group"><label></label></li>'}},constructor:c,buildContainer:function(){this.$container=a(this.options.buttonContainer),this.$container.on("show.bs.dropdown",this.options.onDropdownShow),this.$container.on("hide.bs.dropdown",this.options.onDropdownHide),this.$container.on("shown.bs.dropdown",this.options.onDropdownShown),this.$container.on("hidden.bs.dropdown",this.options.onDropdownHidden)},buildButton:function(){this.$button=a(this.options.templates.button).addClass(this.options.buttonClass),this.$select.attr("class")&&this.options.inheritClass&&this.$button.addClass(this.$select.attr("class")),this.$select.prop("disabled")?this.disable():this.enable(),this.options.buttonWidth&&"auto"!==this.options.buttonWidth&&(this.$button.css({width:this.options.buttonWidth,overflow:"hidden","text-overflow":"ellipsis"}),this.$container.css({width:this.options.buttonWidth}));var b=this.$select.attr("tabindex");b&&this.$button.attr("tabindex",b),this.$container.prepend(this.$button)},buildDropdown:function(){if(this.$ul=a(this.options.templates.ul),this.options.dropRight&&this.$ul.addClass("pull-right"),this.options.maxHeight&&this.$ul.css({"max-height":this.options.maxHeight+"px","overflow-y":"auto","overflow-x":"hidden"}),this.options.dropUp){var b=Math.min(this.options.maxHeight,26*a('option[data-role!="divider"]',this.$select).length+19*a('option[data-role="divider"]',this.$select).length+(this.options.includeSelectAllOption?26:0)+(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering?44:0)),c=b+34;this.$ul.css({"max-height":b+"px","overflow-y":"auto","overflow-x":"hidden","margin-top":"-"+c+"px"})}this.$container.append(this.$ul)},buildDropdownOptions:function(){this.$select.children().each(a.proxy(function(b,c){var d=a(c),e=d.prop("tagName").toLowerCase();d.prop("value")!==this.options.selectAllValue&&("optgroup"===e?this.createOptgroup(c):"option"===e&&("divider"===d.data("role")?this.createDivider():this.createOptionValue(c)))},this)),a("li input",this.$ul).on("change",a.proxy(function(b){var c=a(b.target),d=c.prop("checked")||!1,e=c.val()===this.options.selectAllValue;this.options.selectedClass&&(d?c.closest("li").addClass(this.options.selectedClass):c.closest("li").removeClass(this.options.selectedClass));var f=c.val(),g=this.getOptionByValue(f),h=a("option",this.$select).not(g),i=a("input",this.$container).not(c);return e?d?this.selectAll(this.options.selectAllJustVisible):this.deselectAll(this.options.selectAllJustVisible):(d?(g.prop("selected",!0),this.options.multiple?g.prop("selected",!0):(this.options.selectedClass&&a(i).closest("li").removeClass(this.options.selectedClass),a(i).prop("checked",!1),h.prop("selected",!1),this.$button.click()),"active"===this.options.selectedClass&&h.closest("a").css("outline","")):g.prop("selected",!1),this.options.onChange(g,d)),this.$select.change(),this.updateButtonText(),this.updateSelectAll(),this.options.preventInputChangeEvent?!1:void 0},this)),a("li a",this.$ul).on("mousedown",function(a){return a.shiftKey?!1:void 0}),a("li a",this.$ul).on("touchstart click",a.proxy(function(b){b.stopPropagation();var c=a(b.target);if(b.shiftKey&&this.options.multiple){c.is("label")&&(b.preventDefault(),c=c.find("input"),c.prop("checked",!c.prop("checked")));var d=c.prop("checked")||!1;if(null!==this.lastToggledInput&&this.lastToggledInput!==c){var e=c.closest("li").index(),f=this.lastToggledInput.closest("li").index();if(e>f){var g=f;f=e,e=g}++f;var h=this.$ul.find("li").slice(e,f).find("input");h.prop("checked",d),this.options.selectedClass&&h.closest("li").toggleClass(this.options.selectedClass,d);for(var i=0,j=h.length;j>i;i++){var k=a(h[i]),l=this.getOptionByValue(k.val());l.prop("selected",d)}}c.trigger("change")}c.is("input")&&!c.closest("li").is(".multiselect-item")&&(this.lastToggledInput=c),c.blur()},this)),this.$container.off("keydown.multiselect").on("keydown.multiselect",a.proxy(function(b){if(!a('input[type="text"]',this.$container).is(":focus"))if(9===b.keyCode&&this.$container.hasClass("open"))this.$button.click();else{var c=a(this.$container).find("li:not(.divider):not(.disabled) a").filter(":visible");if(!c.length)return;var d=c.index(c.filter(":focus"));38===b.keyCode&&d>0?d--:40===b.keyCode&&d<c.length-1?d++:~d||(d=0);var e=c.eq(d);if(e.focus(),32===b.keyCode||13===b.keyCode){var f=e.find("input");f.prop("checked",!f.prop("checked")),f.change()}b.stopPropagation(),b.preventDefault()}},this)),this.options.enableClickableOptGroups&&this.options.multiple&&a("li.multiselect-group",this.$ul).on("click",a.proxy(function(b){b.stopPropagation(),console.log("test");var c=a(b.target).parent(),d=c.nextUntil("li.multiselect-group"),e=d.filter(":visible:not(.disabled)"),f=!0,g=e.find("input"),h=[];g.each(function(){f=f&&a(this).prop("checked"),h.push(a(this).val())}),f?this.deselect(h,!1):this.select(h,!1),this.options.onChange(g,!f)},this)),this.options.enableCollapsibleOptGroups&&this.options.multiple&&(a("li.multiselect-group input",this.$ul).off(),a("li.multiselect-group",this.$ul).siblings().not("li.multiselect-group, li.multiselect-all",this.$ul).each(function(){a(this).toggleClass("hidden",!0)}),a("li.multiselect-group",this.$ul).on("click",a.proxy(function(a){a.stopPropagation()},this)),a("li.multiselect-group > a > b",this.$ul).on("click",a.proxy(function(b){b.stopPropagation();var c=a(b.target).closest("li"),d=c.nextUntil("li.multiselect-group"),e=!0;d.each(function(){e=e&&a(this).hasClass("hidden")}),d.toggleClass("hidden",!e)},this)),a("li.multiselect-group > a > input",this.$ul).on("change",a.proxy(function(b){b.stopPropagation();var c=a(b.target).closest("li"),d=c.nextUntil("li.multiselect-group",":not(.disabled)"),e=d.find("input"),f=!0;e.each(function(){f=f&&a(this).prop("checked")}),e.prop("checked",!f).trigger("change")},this)),a("li.multiselect-group",this.$ul).each(function(){var b=a(this).nextUntil("li.multiselect-group",":not(.disabled)"),c=b.find("input"),d=!0;c.each(function(){d=d&&a(this).prop("checked")}),a(this).find("input").prop("checked",d)}),a("li input",this.$ul).on("change",a.proxy(function(b){b.stopPropagation();var c=a(b.target).closest("li"),d=c.prevUntil("li.multiselect-group",":not(.disabled)"),e=c.nextUntil("li.multiselect-group",":not(.disabled)"),f=d.find("input"),g=e.find("input"),h=a(b.target).prop("checked");f.each(function(){h=h&&a(this).prop("checked")}),g.each(function(){h=h&&a(this).prop("checked")}),c.prevAll(".multiselect-group").find("input").prop("checked",h)},this)),a("li.multiselect-all",this.$ul).css("background","#f3f3f3").css("border-bottom","1px solid #eaeaea"),a("li.multiselect-group > a, li.multiselect-all > a > label.checkbox",this.$ul).css("padding","3px 20px 3px 35px"),a("li.multiselect-group > a > input",this.$ul).css("margin","4px 0px 5px -20px"))},createOptionValue:function(b){var c=a(b);c.is(":selected")&&c.prop("selected",!0);var d=this.options.optionLabel(b),e=this.options.optionClass(b),f=c.val(),g=this.options.multiple?"checkbox":"radio",h=a(this.options.templates.li),i=a("label",h);i.addClass(g),h.addClass(e),this.options.enableHTML?i.html(" "+d):i.text(" "+d);var j=a("<input/>").attr("type",g);this.options.checkboxName&&j.attr("name",this.options.checkboxName),i.prepend(j);var k=c.prop("selected")||!1;j.val(f),f===this.options.selectAllValue&&(h.addClass("multiselect-item multiselect-all"),j.parent().parent().addClass("multiselect-all")),i.attr("title",c.attr("title")),this.$ul.append(h),c.is(":disabled")&&j.attr("disabled","disabled").prop("disabled",!0).closest("a").attr("tabindex","-1").closest("li").addClass("disabled"),j.prop("checked",k),k&&this.options.selectedClass&&j.closest("li").addClass(this.options.selectedClass)},createDivider:function(b){var c=a(this.options.templates.divider);this.$ul.append(c)},createOptgroup:function(b){if(this.options.enableCollapsibleOptGroups&&this.options.multiple){var c=a(b).attr("label"),d=a(b).attr("value"),e=a('<li class="multiselect-item multiselect-group"><a href="javascript:void(0);"><input type="checkbox" value="'+d+'"/><b> '+c+'<b class="caret"></b></b></a></li>');this.options.enableClickableOptGroups&&e.addClass("multiselect-group-clickable"),this.$ul.append(e),a(b).is(":disabled")&&e.addClass("disabled"),a("option",b).each(a.proxy(function(a,b){this.createOptionValue(b)},this))}else{var f=a(b).prop("label"),g=a(this.options.templates.liGroup);this.options.enableHTML?a("label",g).html(f):a("label",g).text(f),this.options.enableClickableOptGroups&&g.addClass("multiselect-group-clickable"),this.$ul.append(g),a(b).is(":disabled")&&g.addClass("disabled"),a("option",b).each(a.proxy(function(a,b){this.createOptionValue(b)},this))}},buildSelectAll:function(){"number"==typeof this.options.selectAllValue&&(this.options.selectAllValue=this.options.selectAllValue.toString());var b=this.hasSelectAll();if(!b&&this.options.includeSelectAllOption&&this.options.multiple&&a("option",this.$select).length>this.options.includeSelectAllIfMoreThan){this.options.includeSelectAllDivider&&this.$ul.prepend(a(this.options.templates.divider));var c=a(this.options.templates.li);a("label",c).addClass("checkbox"),this.options.enableHTML?a("label",c).html(" "+this.options.selectAllText):a("label",c).text(" "+this.options.selectAllText),this.options.selectAllName?a("label",c).prepend('<input type="checkbox" name="'+this.options.selectAllName+'" />'):a("label",c).prepend('<input type="checkbox" />');var d=a("input",c);d.val(this.options.selectAllValue),c.addClass("multiselect-item multiselect-all"),d.parent().parent().addClass("multiselect-all"),this.$ul.prepend(c),d.prop("checked",!1)}},buildFilter:function(){if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){var b=Math.max(this.options.enableFiltering,this.options.enableCaseInsensitiveFiltering);if(this.$select.find("option").length>=b){if(this.$filter=a(this.options.templates.filter),a("input",this.$filter).attr("placeholder",this.options.filterPlaceholder),this.options.includeFilterClearBtn){var c=a(this.options.templates.filterClearBtn);c.on("click",a.proxy(function(b){clearTimeout(this.searchTimeout),this.$filter.find(".multiselect-search").val(""),a("li",this.$ul).show().removeClass("filter-hidden"),this.updateSelectAll()},this)),this.$filter.find(".input-group").append(c)}this.$ul.prepend(this.$filter),this.$filter.val(this.query).on("click",function(a){a.stopPropagation()}).on("input keydown",a.proxy(function(b){13===b.which&&b.preventDefault(),clearTimeout(this.searchTimeout),this.searchTimeout=this.asyncFunction(a.proxy(function(){if(this.query!==b.target.value){this.query=b.target.value;var c,d;a.each(a("li",this.$ul),a.proxy(function(b,e){var f=a("input",e).length>0?a("input",e).val():"",g=a("label",e).text(),h="";if("text"===this.options.filterBehavior?h=g:"value"===this.options.filterBehavior?h=f:"both"===this.options.filterBehavior&&(h=g+"\n"+f),f!==this.options.selectAllValue&&g){var i=!1;if(this.options.enableCaseInsensitiveFiltering&&(h=h.toLowerCase(),this.query=this.query.toLowerCase()),this.options.enableFullValueFiltering&&"both"!==this.options.filterBehavior){var j=h.trim().substring(0,this.query.length);this.query.indexOf(j)>-1&&(i=!0)}else h.indexOf(this.query)>-1&&(i=!0);a(e).toggle(i).toggleClass("filter-hidden",!i),a(e).hasClass("multiselect-group")?(c=e,d=i):(i&&a(c).show().removeClass("filter-hidden"),!i&&d&&a(e).show().removeClass("filter-hidden"))}},this))}this.updateSelectAll()},this),300,this)},this))}}},destroy:function(){this.$container.remove(),this.$select.show(),this.$select.data("multiselect",null)},refresh:function(){var b=a.map(a("li input",this.$ul),a);a("option",this.$select).each(a.proxy(function(c,d){for(var e,f=a(d),g=f.val(),h=b.length;0<h--;)if(g===(e=b[h]).val()){f.is(":selected")?(e.prop("checked",!0),this.options.selectedClass&&e.closest("li").addClass(this.options.selectedClass)):(e.prop("checked",!1),this.options.selectedClass&&e.closest("li").removeClass(this.options.selectedClass)),f.is(":disabled")?e.attr("disabled","disabled").prop("disabled",!0).closest("li").addClass("disabled"):e.prop("disabled",!1).closest("li").removeClass("disabled");break}},this)),this.updateButtonText(),this.updateSelectAll()},select:function(b,c){a.isArray(b)||(b=[b]);for(var d=0;d<b.length;d++){var e=b[d];if(null!==e&&void 0!==e){var f=this.getOptionByValue(e),g=this.getInputByValue(e);void 0!==f&&void 0!==g&&(this.options.multiple||this.deselectAll(!1),this.options.selectedClass&&g.closest("li").addClass(this.options.selectedClass),g.prop("checked",!0),f.prop("selected",!0),c&&this.options.onChange(f,!0))}}this.updateButtonText(),this.updateSelectAll()},clearSelection:function(){this.deselectAll(!1),this.updateButtonText(),this.updateSelectAll()},deselect:function(b,c){a.isArray(b)||(b=[b]);for(var d=0;d<b.length;d++){var e=b[d];if(null!==e&&void 0!==e){var f=this.getOptionByValue(e),g=this.getInputByValue(e);void 0!==f&&void 0!==g&&(this.options.selectedClass&&g.closest("li").removeClass(this.options.selectedClass),g.prop("checked",!1),f.prop("selected",!1),c&&this.options.onChange(f,!1))}}this.updateButtonText(),this.updateSelectAll()},selectAll:function(b,c){b=this.options.enableCollapsibleOptGroups&&this.options.multiple?!1:b;var b="undefined"==typeof b?!0:b,d=a("li input[type='checkbox']:enabled",this.$ul),e=d.filter(":visible"),f=d.length,g=e.length;if(b?(e.prop("checked",!0),a("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").addClass(this.options.selectedClass)):(d.prop("checked",!0),a("li:not(.divider):not(.disabled)",this.$ul).addClass(this.options.selectedClass)),f===g||b===!1)a("option:not([data-role='divider']):enabled",this.$select).prop("selected",!0);else{var h=e.map(function(){return a(this).val()}).get();a("option:enabled",this.$select).filter(function(b){return-1!==a.inArray(a(this).val(),h)}).prop("selected",!0)}c&&this.options.onSelectAll()},deselectAll:function(b){if(b=this.options.enableCollapsibleOptGroups&&this.options.multiple?!1:b,b="undefined"==typeof b?!0:b){var c=a("li input[type='checkbox']:not(:disabled)",this.$ul).filter(":visible");c.prop("checked",!1);var d=c.map(function(){return a(this).val()}).get();a("option:enabled",this.$select).filter(function(b){return-1!==a.inArray(a(this).val(),d)}).prop("selected",!1),this.options.selectedClass&&a("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").removeClass(this.options.selectedClass)}else a("li input[type='checkbox']:enabled",this.$ul).prop("checked",!1),a("option:enabled",this.$select).prop("selected",!1),this.options.selectedClass&&a("li:not(.divider):not(.disabled)",this.$ul).removeClass(this.options.selectedClass)},rebuild:function(){this.$ul.html(""),this.options.multiple="multiple"===this.$select.attr("multiple"),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(!0),this.options.disableIfEmpty&&a("option",this.$select).length<=0?this.disable():this.enable(),this.options.dropRight&&this.$ul.addClass("pull-right")},dataprovider:function(c){var d=0,e=this.$select.empty();a.each(c,function(c,f){var g;a.isArray(f.children)?(d++,g=a("<optgroup/>").attr({label:f.label||"Group "+d,disabled:!!f.disabled}),b(f.children,function(b){g.append(a("<option/>").attr({value:b.value,label:b.label||b.value,title:b.title,selected:!!b.selected,disabled:!!b.disabled}))})):(g=a("<option/>").attr({value:f.value,label:f.label||f.value,title:f.title,"class":f["class"],selected:!!f.selected,disabled:!!f.disabled}),g.text(f.label||f.value)),e.append(g)}),this.rebuild()},enable:function(){this.$select.prop("disabled",!1),this.$button.prop("disabled",!1).removeClass("disabled")},disable:function(){this.$select.prop("disabled",!0),this.$button.prop("disabled",!0).addClass("disabled")},setOptions:function(a){this.options=this.mergeOptions(a)},mergeOptions:function(b){return a.extend(!0,{},this.defaults,this.options,b)},hasSelectAll:function(){return a("li.multiselect-all",this.$ul).length>0},updateSelectAll:function(b){if(this.hasSelectAll()){var c=a("li:not(.multiselect-item):not(.filter-hidden) input:enabled",this.$ul),d=c.length,e=c.filter(":checked").length,f=a("li.multiselect-all",this.$ul),g=f.find("input");e>0&&e===d?(g.prop("checked",!0),f.addClass(this.options.selectedClass),this.options.onSelectAll(!0)):(g.prop("checked",!1),f.removeClass(this.options.selectedClass),0===e&&(b||this.options.onSelectAll(!1)))}},updateButtonText:function(){var b=this.getSelected();this.options.enableHTML?a(".multiselect .multiselect-selected-text",this.$container).html(this.options.buttonText(b,this.$select)):a(".multiselect .multiselect-selected-text",this.$container).text(this.options.buttonText(b,this.$select)),a(".multiselect",this.$container).attr("title",this.options.buttonTitle(b,this.$select))},getSelected:function(){return a("option",this.$select).filter(":selected")},getOptionByValue:function(b){for(var c=a("option",this.$select),d=b.toString(),e=0;e<c.length;e+=1){var f=c[e];if(f.value===d)return a(f)}},getInputByValue:function(b){for(var c=a("li input",this.$ul),d=b.toString(),e=0;e<c.length;e+=1){var f=c[e];if(f.value===d)return a(f)}},updateOriginalOptions:function(){this.originalOptions=this.$select.clone()[0].options},asyncFunction:function(a,b,c){var d=Array.prototype.slice.call(arguments,3);return setTimeout(function(){a.apply(c||window,d)},b)},setAllSelectedText:function(a){this.options.allSelectedText=a,this.updateButtonText()}},a.fn.multiselect=function(b,d,e){return this.each(function(){var f=a(this).data("multiselect"),g="object"==typeof b&&b;f||(f=new c(this,g),a(this).data("multiselect",f)),"string"==typeof b&&(f[b](d,e),"destroy"===b&&a(this).data("multiselect",!1))})},a.fn.multiselect.Constructor=c,a(function(){a("select[data-role=multiselect]").multiselect()})}(window.jQuery),jQuery.cookie=function(a,b,c){if(arguments.length>1&&"[object Object]"!==String(b)){if(c=jQuery.extend({},c),(null===b||void 0===b)&&(c.expires=-1),"number"==typeof c.expires){var d=c.expires,e=c.expires=new Date;e.setDate(e.getDate()+d)}return b=String(b),document.cookie=[encodeURIComponent(a),"=",c.raw?b:encodeURIComponent(b),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=b||{};var f,g=c.raw?function(a){return a}:decodeURIComponent;return(f=new RegExp("(?:^|; )"+encodeURIComponent(a)+"=([^;]*)").exec(document.cookie))?g(f[1]):null},function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;e.length>d;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(c,d,e){var f,g,h,i,j={},k=c.split(".")[0];c=c.split(".")[1],f=k+"-"+c,e||(e=d,d=a.Widget),a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)},a[k]=a[k]||{},g=a[k][c],h=a[k][c]=function(a,c){return this._createWidget?(arguments.length&&this._createWidget(a,c),b):new h(a,c)},a.extend(h,g,{version:e.version,_proto:a.extend({},e),_childConstructors:[]}),i=new d,i.options=a.widget.extend({},i.options),a.each(e,function(c,e){return a.isFunction(e)?(j[c]=function(){var a=function(){return d.prototype[c].apply(this,arguments)},b=function(a){return d.prototype[c].apply(this,a)};return function(){var c,d=this._super,f=this._superApply;return this._super=a,this._superApply=b,c=e.apply(this,arguments),this._super=d,this._superApply=f,c}}(),b):(j[c]=e,b)}),h.prototype=a.widget.extend(i,{widgetEventPrefix:g?i.widgetEventPrefix:c},j,{constructor:h,namespace:k,widgetName:c,widgetFullName:f}),g?(a.each(g._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,h,c._proto)}),delete g._childConstructors):d._childConstructors.push(h),a.widget.bridge(c,h)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):b):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),
d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1),e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget()),a.each(e,function(e,h){function i(){return c||g.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):b}"string"!=typeof h&&(i.guid=h.guid=h.guid||i.guid||a.guid++);var j=e.match(/^(\w+)\s*(.*)$/),k=j[1]+g.eventNamespace,l=j[2];l?f.delegate(l,k,i):d.bind(k,i)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a,b){function c(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function d(b,c){return parseInt(a.css(b,c),10)||0}function e(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(f!==b)return f;var c,d,e=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),g=e.children()[0];return a("body").append(e),c=g.offsetWidth,e.css("overflow","scroll"),d=g.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(b){var c=b.isWindow?"":b.element.css("overflow-x"),d=b.isWindow?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]);return{element:c,isWindow:d,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d?c.width():c.outerWidth(),height:d?c.height():c.outerHeight()}}},a.fn.position=function(b){if(!b||!b.of)return o.apply(this,arguments);b=a.extend({},b);var f,n,p,q,r,s,t=a(b.of),u=a.position.getWithinInfo(b.within),v=a.position.getScrollInfo(u),w=(b.collision||"flip").split(" "),x={};return s=e(t),t[0].preventDefault&&(b.at="left top"),n=s.width,p=s.height,q=s.offset,r=a.extend({},q),a.each(["my","at"],function(){var a,c,d=(b[this]||"").split(" ");1===d.length&&(d=j.test(d[0])?d.concat(["center"]):k.test(d[0])?["center"].concat(d):["center","center"]),d[0]=j.test(d[0])?d[0]:"center",d[1]=k.test(d[1])?d[1]:"center",a=l.exec(d[0]),c=l.exec(d[1]),x[this]=[a?a[0]:0,c?c[0]:0],b[this]=[m.exec(d[0])[0],m.exec(d[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===b.at[0]?r.left+=n:"center"===b.at[0]&&(r.left+=n/2),"bottom"===b.at[1]?r.top+=p:"center"===b.at[1]&&(r.top+=p/2),f=c(x.at,n,p),r.left+=f[0],r.top+=f[1],this.each(function(){var e,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=d(this,"marginLeft"),s=d(this,"marginTop"),y=l+o+d(this,"marginRight")+v.width,z=m+s+d(this,"marginBottom")+v.height,A=a.extend({},r),B=c(x.my,k.outerWidth(),k.outerHeight());"right"===b.my[0]?A.left-=l:"center"===b.my[0]&&(A.left-=l/2),"bottom"===b.my[1]?A.top-=m:"center"===b.my[1]&&(A.top-=m/2),A.left+=B[0],A.top+=B[1],a.support.offsetFractions||(A.left=i(A.left),A.top=i(A.top)),e={marginLeft:o,marginTop:s},a.each(["left","top"],function(c,d){a.ui.position[w[c]]&&a.ui.position[w[c]][d](A,{targetWidth:n,targetHeight:p,elemWidth:l,elemHeight:m,collisionPosition:e,collisionWidth:y,collisionHeight:z,offset:[f[0]+B[0],f[1]+B[1]],my:b.my,at:b.at,within:u,elem:k})}),b.using&&(j=function(a){var c=q.left-A.left,d=c+n-l,e=q.top-A.top,f=e+p-m,i={target:{element:t,left:q.left,top:q.top,width:n,height:p},element:{element:k,left:A.left,top:A.top,width:l,height:m},horizontal:0>d?"left":c>0?"right":"center",vertical:0>f?"top":e>0?"bottom":"middle"};l>n&&n>h(c+d)&&(i.horizontal="center"),m>p&&p>h(e+f)&&(i.vertical="middle"),i.important=g(h(c),h(d))>g(h(e),h(f))?"horizontal":"vertical",b.using.call(this,a,i)}),k.offset(a.extend(A,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):a.left=j>0&&0>=i?e:i>j?e+f-b.collisionWidth:e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):a.top=j>0&&0>=i?e:i>j?e+f-b.collisionHeight:e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(c=a.left+m+n+o+b.collisionWidth-g-f,(0>c||h(k)>c)&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||l>h(d))&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(0>d||h(k)>d)&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||l>h(c))&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");b=document.createElement(g?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(h),c=g||document.documentElement,c.insertBefore(b,c.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",e=a(h).offset().left,a.support.offsetFractions=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(jQuery),function(a){var b=0;a.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var b,c,d,e=this.element[0].nodeName.toLowerCase(),f="textarea"===e,g="input"===e;this.isMultiLine=f?!0:g?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[f||g?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","none"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))return b=!0,d=!0,void(c=!0);b=!1,d=!1,c=!1;var f=a.ui.keyCode;switch(e.keyCode){case f.PAGE_UP:b=!0,this._move("previousPage",e);break;case f.PAGE_DOWN:b=!0,this._move("nextPage",e);break;case f.UP:b=!0,this._keyEvent("previous",e);break;case f.DOWN:b=!0,this._keyEvent("next",e);break;case f.ENTER:case f.NUMPAD_ENTER:this.menu.active&&(b=!0,e.preventDefault(),this.menu.select(e));break;case f.TAB:this.menu.active&&this.menu.select(e);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}},keypress:function(d){if(b)return b=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&d.preventDefault());if(!c){var e=a.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:this._move("previousPage",d);break;case e.PAGE_DOWN:this._move("nextPage",d);break;case e.UP:this._keyEvent("previous",d);break;case e.DOWN:this._keyEvent("next",d)}}},input:function(a){return d?(d=!1,void a.preventDefault()):void this._searchTimeout(a)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),void this._change(a))}}),this._initSource(),this.menu=a("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(b){b.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var c=this.menu.element[0];a(b.target).closest(".ui-menu-item").length||this._delay(function(){var b=this;this.document.one("mousedown",function(d){d.target===b.element[0]||d.target===c||a.contains(c,d.target)||b.close()})})},menufocus:function(b,c){if(this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)});var d=c.item.data("ui-autocomplete-item");!1!==this._trigger("focus",b,{item:d})?b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(d.value):this.liveRegion.text(d.value)},menuselect:function(a,b){var c=b.item.data("ui-autocomplete-item"),d=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d,this.selectedItem=c})),!1!==this._trigger("select",a,{item:c})&&this._value(c.value),this.term=this._value(),this.close(a),this.selectedItem=c}}),this.liveRegion=a("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(a,b){this._super(a,b),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&b&&this.xhr&&this.xhr.abort()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_initSource:function(){var b,c,d=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(c,d){d(a.ui.autocomplete.filter(b,c.term))}):"string"==typeof this.options.source?(c=this.options.source,this.source=function(b,e){d.xhr&&d.xhr.abort(),d.xhr=a.ajax({url:c,data:b,dataType:"json",success:function(a){e(a)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){return a=null!=a?a:this._value(),this.term=this._value(),a.length<this.options.minLength?this.close(b):this._trigger("search",b)!==!1?this._search(a):void 0},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:a},this._response())},_response:function(){var a=this,c=++b;return function(d){c===b&&a.__response(d),a.pending--,a.pending||a.element.removeClass("ui-autocomplete-loading")}},__response:function(a){a&&(a=this._normalize(a)),this._trigger("response",null,{content:a}),!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0,this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty();this._renderMenu(c,b),this.isNewMenu=!0,this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItemData(b,c)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){return a("<li>").append(a("<a>").text(c.label)).appendTo(b)},_move:function(a,b){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this._value(this.term),void this.menu.blur()):void this.menu[a](b):void this.search(null,b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(a,b),b.preventDefault())}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}}),a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(a){var b;this._superApply(arguments),this.options.disabled||this.cancelSearch||(b=a&&a.length?this.options.messages.results(a.length):this.options.messages.noResults,this.liveRegion.text(b))}})}(jQuery),function(a){a.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,a.proxy(function(a){this.options.disabled&&a.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(a){a.preventDefault()},"click .ui-state-disabled > a":function(a){a.preventDefault()},"click .ui-menu-item:has(a)":function(b){var c=a(b.target).closest(".ui-menu-item");!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(b),c.has(".ui-menu").length?this.expand(b):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){var c=a(b.currentTarget);c.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.children(".ui-menu-item").eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var d,e,f,g,h,i=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:i=!1,e=this.previousFilter||"",f=String.fromCharCode(b.keyCode),g=!1,clearTimeout(this.filterTimer),f===e?g=!0:f=e+f,h=RegExp("^"+c(f),"i"),d=this.activeMenu.children(".ui-menu-item").filter(function(){return h.test(a(this).children("a").text())}),d=g&&-1!==d.index(this.active.next())?this.active.nextAll(".ui-menu-item"):d,d.length||(f=String.fromCharCode(b.keyCode),h=RegExp("^"+c(f),"i"),d=this.activeMenu.children(".ui-menu-item").filter(function(){return h.test(a(this).children("a").text())})),d.length?(this.focus(b,d),d.length>1?(this.previousFilter=f,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}i&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(a):this.select(a))},refresh:function(){var b,c=this.options.icons.submenu,d=this.element.find(this.options.menus);d.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),d=b.prev("a"),e=a("<span>").addClass("ui-menu-icon ui-icon "+c).data("ui-menu-submenu-carat",!0);d.attr("aria-haspopup","true").prepend(e),b.attr("aria-labelledby",d.attr("id"))}),b=d.add(this.element),b.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),b.children(":not(.ui-menu-item)").each(function(){var b=a(this);/[^\-\u2014\u2013\s]/.test(b.text())||b.addClass("ui-widget-content ui-menu-divider")}),b.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.height(),0>e?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.children(".ui-menu-item")[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;return this.active?void(this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),0>c.offset().top-d-e}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(b)},previousPage:function(b){var c,d,e;return this.active?void(this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item").first()))):void this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)}})}(jQuery),function(a){"use strict";function b(b){var c=b.data;b.isDefaultPrevented()||(b.preventDefault(),a(b.target).ajaxSubmit(c))}function c(b){var c=b.target,d=a(c);if(!d.is("[type=submit],[type=image]")){var e=d.closest("[type=submit]");if(0===e.length)return;c=e[0]}var f=this;if(f.clk=c,"image"==c.type)if(void 0!==b.offsetX)f.clk_x=b.offsetX,f.clk_y=b.offsetY;else if("function"==typeof a.fn.offset){var g=d.offset();f.clk_x=b.pageX-g.left,f.clk_y=b.pageY-g.top}else f.clk_x=b.pageX-c.offsetLeft,f.clk_y=b.pageY-c.offsetTop;setTimeout(function(){f.clk=f.clk_x=f.clk_y=null},100)}function d(){if(a.fn.ajaxSubmit.debug){var b="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(b):window.opera&&window.opera.postError&&window.opera.postError(b)}}var e={};e.fileapi=void 0!==a("<input type='file'/>").get(0).files,e.formdata=void 0!==window.FormData;var f=!!a.fn.prop;a.fn.attr2=function(){if(!f)return this.attr.apply(this,arguments);var a=this.prop.apply(this,arguments);return a&&a.jquery||"string"==typeof a?a:this.attr.apply(this,arguments)},a.fn.ajaxSubmit=function(b){function c(c){var d,e,f=a.param(c,b.traditional).split("&"),g=f.length,h=[];for(d=0;g>d;d++)f[d]=f[d].replace(/\+/g," "),e=f[d].split("="),h.push([decodeURIComponent(e[0]),decodeURIComponent(e[1])]);return h}function g(d){for(var e=new FormData,f=0;d.length>f;f++)e.append(d[f].name,d[f].value);if(b.extraData){var g=c(b.extraData);for(f=0;g.length>f;f++)g[f]&&e.append(g[f][0],g[f][1])}b.data=null;var h=a.extend(!0,{},a.ajaxSettings,b,{contentType:!1,processData:!1,cache:!1,type:i||"POST"});b.uploadProgress&&(h.xhr=function(){var c=a.ajaxSettings.xhr();return c.upload&&c.upload.addEventListener("progress",function(a){var c=0,d=a.loaded||a.position,e=a.total;a.lengthComputable&&(c=Math.ceil(100*(d/e))),b.uploadProgress(a,d,e,c)},!1),c}),h.data=null;var j=h.beforeSend;return h.beforeSend=function(a,c){c.data=b.formData?b.formData:e,j&&j.call(this,a,c)},a.ajax(h)}function h(c){function e(a){var b=null;try{a.contentWindow&&(b=a.contentWindow.document)}catch(c){d("cannot get iframe.contentWindow document: "+c)}if(b)return b;try{b=a.contentDocument?a.contentDocument:a.document}catch(c){d("cannot get iframe.contentDocument: "+c),b=a.document}return b}function g(){function b(){try{var a=e(r).readyState;d("state = "+a),a&&"uninitialized"==a.toLowerCase()&&setTimeout(b,50)}catch(c){d("Server abort: ",c," (",c.name,")"),h(A),w&&clearTimeout(w),w=void 0}}var c=l.attr2("target"),f=l.attr2("action");x.setAttribute("target",o),(!i||/post/i.test(i))&&x.setAttribute("method","POST"),f!=m.url&&x.setAttribute("action",m.url),m.skipEncodingOverride||i&&!/post/i.test(i)||l.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),m.timeout&&(w=setTimeout(function(){v=!0,h(z)},m.timeout));var g=[];try{if(m.extraData)for(var j in m.extraData)m.extraData.hasOwnProperty(j)&&(a.isPlainObject(m.extraData[j])&&m.extraData[j].hasOwnProperty("name")&&m.extraData[j].hasOwnProperty("value")?g.push(a('<input type="hidden" name="'+m.extraData[j].name+'">').val(m.extraData[j].value).appendTo(x)[0]):g.push(a('<input type="hidden" name="'+j+'">').val(m.extraData[j]).appendTo(x)[0]));m.iframeTarget||q.appendTo("body"),r.attachEvent?r.attachEvent("onload",h):r.addEventListener("load",h,!1),setTimeout(b,15);try{x.submit()}catch(k){var n=document.createElement("form").submit;n.apply(x)}}finally{x.setAttribute("action",f),c?x.setAttribute("target",c):l.removeAttr("target"),a(g).remove()}}function h(b){if(!s.aborted&&!F){if(E=e(r),E||(d("cannot access response document"),b=A),b===z&&s)return s.abort("timeout"),void y.reject(s,"timeout");if(b==A&&s)return s.abort("server abort"),void y.reject(s,"error","server abort");if(E&&E.location.href!=m.iframeSrc||v){r.detachEvent?r.detachEvent("onload",h):r.removeEventListener("load",h,!1);var c,f="success";try{if(v)throw"timeout";var g="xml"==m.dataType||E.XMLDocument||a.isXMLDoc(E);if(d("isXml="+g),!g&&window.opera&&(null===E.body||!E.body.innerHTML)&&--G)return d("requeing onLoad callback, DOM not available"),void setTimeout(h,250);var i=E.body?E.body:E.documentElement;s.responseText=i?i.innerHTML:null,s.responseXML=E.XMLDocument?E.XMLDocument:E,g&&(m.dataType="xml"),s.getResponseHeader=function(a){var b={"content-type":m.dataType};return b[a.toLowerCase()]},i&&(s.status=Number(i.getAttribute("status"))||s.status,s.statusText=i.getAttribute("statusText")||s.statusText);var j=(m.dataType||"").toLowerCase(),k=/(json|script|text)/.test(j);if(k||m.textarea){var l=E.getElementsByTagName("textarea")[0];if(l)s.responseText=l.value,s.status=Number(l.getAttribute("status"))||s.status,s.statusText=l.getAttribute("statusText")||s.statusText;else if(k){var o=E.getElementsByTagName("pre")[0],p=E.getElementsByTagName("body")[0];o?s.responseText=o.textContent?o.textContent:o.innerText:p&&(s.responseText=p.textContent?p.textContent:p.innerText)}}else"xml"==j&&!s.responseXML&&s.responseText&&(s.responseXML=H(s.responseText));try{D=J(s,j,m)}catch(t){f="parsererror",s.error=c=t||f}}catch(t){d("error caught: ",t),f="error",s.error=c=t||f}s.aborted&&(d("upload aborted"),f=null),s.status&&(f=s.status>=200&&300>s.status||304===s.status?"success":"error"),"success"===f?(m.success&&m.success.call(m.context,D,"success",s),y.resolve(s.responseText,"success",s),n&&a.event.trigger("ajaxSuccess",[s,m])):f&&(void 0===c&&(c=s.statusText),m.error&&m.error.call(m.context,s,f,c),y.reject(s,"error",c),n&&a.event.trigger("ajaxError",[s,m,c])),n&&a.event.trigger("ajaxComplete",[s,m]),n&&!--a.active&&a.event.trigger("ajaxStop"),m.complete&&m.complete.call(m.context,s,f),F=!0,m.timeout&&clearTimeout(w),setTimeout(function(){m.iframeTarget?q.attr("src",m.iframeSrc):q.remove(),s.responseXML=null},100)}}}var j,k,m,n,o,q,r,s,t,u,v,w,x=l[0],y=a.Deferred();if(y.abort=function(a){s.abort(a)},c)for(k=0;p.length>k;k++)j=a(p[k]),f?j.prop("disabled",!1):j.removeAttr("disabled");if(m=a.extend(!0,{},a.ajaxSettings,b),m.context=m.context||m,o="jqFormIO"+(new Date).getTime(),m.iframeTarget?(q=a(m.iframeTarget),u=q.attr2("name"),u?o=u:q.attr2("name",o)):(q=a('<iframe name="'+o+'" src="'+m.iframeSrc+'" />'),q.css({position:"absolute",top:"-1000px",left:"-1000px"})),r=q[0],s={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(b){var c="timeout"===b?"timeout":"aborted";d("aborting upload... "+c),this.aborted=1;try{r.contentWindow.document.execCommand&&r.contentWindow.document.execCommand("Stop");
}catch(e){}q.attr("src",m.iframeSrc),s.error=c,m.error&&m.error.call(m.context,s,c,b),n&&a.event.trigger("ajaxError",[s,m,c]),m.complete&&m.complete.call(m.context,s,c)}},n=m.global,n&&0===a.active++&&a.event.trigger("ajaxStart"),n&&a.event.trigger("ajaxSend",[s,m]),m.beforeSend&&m.beforeSend.call(m.context,s,m)===!1)return m.global&&a.active--,y.reject(),y;if(s.aborted)return y.reject(),y;t=x.clk,t&&(u=t.name,u&&!t.disabled&&(m.extraData=m.extraData||{},m.extraData[u]=t.value,"image"==t.type&&(m.extraData[u+".x"]=x.clk_x,m.extraData[u+".y"]=x.clk_y)));var z=1,A=2,B=a("meta[name=csrf-token]").attr("content"),C=a("meta[name=csrf-param]").attr("content");C&&B&&(m.extraData=m.extraData||{},m.extraData[C]=B),m.forceSync?g():setTimeout(g,10);var D,E,F,G=50,H=a.parseXML||function(a,b){return window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b&&b.documentElement&&"parsererror"!=b.documentElement.nodeName?b:null},I=a.parseJSON||function(a){return window.eval("("+a+")")},J=function(b,c,d){var e=b.getResponseHeader("content-type")||"",f="xml"===c||!c&&e.indexOf("xml")>=0,g=f?b.responseXML:b.responseText;return f&&"parsererror"===g.documentElement.nodeName&&a.error&&a.error("parsererror"),d&&d.dataFilter&&(g=d.dataFilter(g,c)),"string"==typeof g&&("json"===c||!c&&e.indexOf("json")>=0?g=I(g):("script"===c||!c&&e.indexOf("javascript")>=0)&&a.globalEval(g)),g};return y}if(!this.length)return d("ajaxSubmit: skipping submit process - no element selected"),this;var i,j,k,l=this;"function"==typeof b?b={success:b}:void 0===b&&(b={}),i=b.type||this.attr2("method"),j=b.url||this.attr2("action"),k="string"==typeof j?a.trim(j):"",k=k||window.location.href||"",k&&(k=(k.match(/^([^#]+)/)||[])[1]),b=a.extend(!0,{url:k,success:a.ajaxSettings.success,type:i||a.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},b);var m={};if(this.trigger("form-pre-serialize",[this,b,m]),m.veto)return d("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(b.beforeSerialize&&b.beforeSerialize(this,b)===!1)return d("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var n=b.traditional;void 0===n&&(n=a.ajaxSettings.traditional);var o,p=[],q=this.formToArray(b.semantic,p);if(b.data&&(b.extraData=b.data,o=a.param(b.data,n)),b.beforeSubmit&&b.beforeSubmit(q,this,b)===!1)return d("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[q,this,b,m]),m.veto)return d("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var r=a.param(q,n);o&&(r=r?r+"&"+o:o),"GET"==b.type.toUpperCase()?(b.url+=(b.url.indexOf("?")>=0?"&":"?")+r,b.data=null):b.data=r;var s=[];if(b.resetForm&&s.push(function(){l.resetForm()}),b.clearForm&&s.push(function(){l.clearForm(b.includeHidden)}),!b.dataType&&b.target){var t=b.success||function(){};s.push(function(c){var d=b.replaceTarget?"replaceWith":"html";a(b.target)[d](c).each(t,arguments)})}else b.success&&s.push(b.success);if(b.success=function(a,c,d){for(var e=b.context||this,f=0,g=s.length;g>f;f++)s[f].apply(e,[a,c,d||l,l])},b.error){var u=b.error;b.error=function(a,c,d){var e=b.context||this;u.apply(e,[a,c,d,l])}}if(b.complete){var v=b.complete;b.complete=function(a,c){var d=b.context||this;v.apply(d,[a,c,l])}}var w=a("input[type=file]:enabled",this).filter(function(){return""!==a(this).val()}),x=w.length>0,y="multipart/form-data",z=l.attr("enctype")==y||l.attr("encoding")==y,A=e.fileapi&&e.formdata;d("fileAPI :"+A);var B,C=(x||z)&&!A;b.iframe!==!1&&(b.iframe||C)?b.closeKeepAlive?a.get(b.closeKeepAlive,function(){B=h(q)}):B=h(q):B=(x||z)&&A?g(q):a.ajax(b),l.removeData("jqxhr").data("jqxhr",B);for(var D=0;p.length>D;D++)p[D]=null;return this.trigger("form-submit-notify",[this,b]),this},a.fn.ajaxForm=function(e){if(e=e||{},e.delegation=e.delegation&&a.isFunction(a.fn.on),!e.delegation&&0===this.length){var f={s:this.selector,c:this.context};return!a.isReady&&f.s?(d("DOM not ready, queuing ajaxForm"),a(function(){a(f.s,f.c).ajaxForm(e)}),this):(d("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)")),this)}return e.delegation?(a(document).off("submit.form-plugin",this.selector,b).off("click.form-plugin",this.selector,c).on("submit.form-plugin",this.selector,e,b).on("click.form-plugin",this.selector,e,c),this):this.ajaxFormUnbind().bind("submit.form-plugin",e,b).bind("click.form-plugin",e,c)},a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},a.fn.formToArray=function(b,c){var d=[];if(0===this.length)return d;var f=this[0],g=b?f.getElementsByTagName("*"):f.elements;if(!g)return d;var h,i,j,k,l,m,n;for(h=0,m=g.length;m>h;h++)if(l=g[h],j=l.name,j&&!l.disabled)if(b&&f.clk&&"image"==l.type)f.clk==l&&(d.push({name:j,value:a(l).val(),type:l.type}),d.push({name:j+".x",value:f.clk_x},{name:j+".y",value:f.clk_y}));else if(k=a.fieldValue(l,!0),k&&k.constructor==Array)for(c&&c.push(l),i=0,n=k.length;n>i;i++)d.push({name:j,value:k[i]});else if(e.fileapi&&"file"==l.type){c&&c.push(l);var o=l.files;if(o.length)for(i=0;o.length>i;i++)d.push({name:j,value:o[i],type:l.type});else d.push({name:j,value:"",type:l.type})}else null!==k&&void 0!==k&&(c&&c.push(l),d.push({name:j,value:k,type:l.type,required:l.required}));if(!b&&f.clk){var p=a(f.clk),q=p[0];j=q.name,j&&!q.disabled&&"image"==q.type&&(d.push({name:j,value:p.val()}),d.push({name:j+".x",value:f.clk_x},{name:j+".y",value:f.clk_y}))}return d},a.fn.formSerialize=function(b){return a.param(this.formToArray(b))},a.fn.fieldSerialize=function(b){var c=[];return this.each(function(){var d=this.name;if(d){var e=a.fieldValue(this,b);if(e&&e.constructor==Array)for(var f=0,g=e.length;g>f;f++)c.push({name:d,value:e[f]});else null!==e&&void 0!==e&&c.push({name:this.name,value:e})}}),a.param(c)},a.fn.fieldValue=function(b){for(var c=[],d=0,e=this.length;e>d;d++){var f=this[d],g=a.fieldValue(f,b);null===g||void 0===g||g.constructor==Array&&!g.length||(g.constructor==Array?a.merge(c,g):c.push(g))}return c},a.fieldValue=function(b,c){var d=b.name,e=b.type,f=b.tagName.toLowerCase();if(void 0===c&&(c=!0),c&&(!d||b.disabled||"reset"==e||"button"==e||("checkbox"==e||"radio"==e)&&!b.checked||("submit"==e||"image"==e)&&b.form&&b.form.clk!=b||"select"==f&&-1==b.selectedIndex))return null;if("select"==f){var g=b.selectedIndex;if(0>g)return null;for(var h=[],i=b.options,j="select-one"==e,k=j?g+1:i.length,l=j?g:0;k>l;l++){var m=i[l];if(m.selected){var n=m.value;if(n||(n=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value),j)return n;h.push(n)}}return h}return a(b).val()},a.fn.clearForm=function(b){return this.each(function(){a("input,select,textarea",this).clearFields(b)})},a.fn.clearFields=a.fn.clearInputs=function(b){var c=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var d=this.type,e=this.tagName.toLowerCase();c.test(d)||"textarea"==e?this.value="":"checkbox"==d||"radio"==d?this.checked=!1:"select"==e?this.selectedIndex=-1:"file"==d?/MSIE/.test(navigator.userAgent)?a(this).replaceWith(a(this).clone(!0)):a(this).val(""):b&&(b===!0&&/hidden/.test(d)||"string"==typeof b&&a(this).is(b))&&(this.value="")})},a.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},a.fn.enable=function(a){return void 0===a&&(a=!0),this.each(function(){this.disabled=!a})},a.fn.selected=function(b){return void 0===b&&(b=!0),this.each(function(){var c=this.type;if("checkbox"==c||"radio"==c)this.checked=b;else if("option"==this.tagName.toLowerCase()){var d=a(this).parent("select");b&&d[0]&&"select-one"==d[0].type&&d.find("option").selected(!1),this.selected=b}})},a.fn.ajaxSubmit.debug=!1}("undefined"!=typeof jQuery?jQuery:window.Zepto),jQuery.base64=function(a){function b(a,b){var c=g.indexOf(a.charAt(b));if(-1===c)throw"Cannot decode base64";return c}function c(a){var c,d,e=0,g=a.length,h=[];if(a=String(a),0===g)return a;if(g%4!==0)throw"Cannot decode base64";for(a.charAt(g-1)===f&&(e=1,a.charAt(g-2)===f&&(e=2),g-=4),c=0;g>c;c+=4)d=b(a,c)<<18|b(a,c+1)<<12|b(a,c+2)<<6|b(a,c+3),h.push(String.fromCharCode(d>>16,d>>8&255,255&d));switch(e){case 1:d=b(a,c)<<18|b(a,c+1)<<12|b(a,c+2)<<6,h.push(String.fromCharCode(d>>16,d>>8&255));break;case 2:d=b(a,c)<<18|b(a,c+1)<<12,h.push(String.fromCharCode(d>>16))}return h.join("")}function d(a,b){var c=a.charCodeAt(b);if(c>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return c}function e(a){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";a=String(a);var b,c,e=[],h=a.length-a.length%3;if(0===a.length)return a;for(b=0;h>b;b+=3)c=d(a,b)<<16|d(a,b+1)<<8|d(a,b+2),e.push(g.charAt(c>>18)),e.push(g.charAt(c>>12&63)),e.push(g.charAt(c>>6&63)),e.push(g.charAt(63&c));switch(a.length-h){case 1:c=d(a,b)<<16,e.push(g.charAt(c>>18)+g.charAt(c>>12&63)+f+f);break;case 2:c=d(a,b)<<16|d(a,b+1)<<8,e.push(g.charAt(c>>18)+g.charAt(c>>12&63)+g.charAt(c>>6&63)+f)}return e.join("")}var f="=",g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="1.0";return{decode:c,encode:e,VERSION:h}}(jQuery),function(a){function b(){d.call(this,"city")}function c(){d.call(this,"region")}function d(b){if(a.vvLocator.locationData)return void e.call(this,b);var c=this;a.ajax({url:site_url("geography/locate_position"),type:"GET",traditional:!0,context:this,dataType:"json",success:function(d){d.success&&(a.vvLocator.locationData=d.details,e.call(c,b),a(document).trigger("complete.locator"))},error:function(a,b,c){},complete:function(){}})}function e(b){var c=a.vvLocator.locationData;switch(c.country&&(a(".x-locator-country",this).val(c.country.id),a(".x-listing-country-selector",this).vvListingCountrySelect()),b){case"city":c.city&&a(".x-locator-city",this).val(c.city.name);break;case"region":c.region&&a(".x-locator-region",this).val(c.region.name)}}a.vvLocator={locationData:null},a.fn.extend({vvLocator:function(d){return this.each(function(){var d=this;a(".x-locator-city-btn").click(function(){b.call(d)}),a(".x-locator-region-btn").click(function(){c.call(d)})})}})}(jQuery),function(){function a(a){function b(b,d){var f,o,p=b==window,q=d&&void 0!==d.message?d.message:void 0;if(d=a.extend({},a.blockUI.defaults,d||{}),!d.ignoreIfBlocked||!a(b).data("blockUI.isBlocked")){if(d.overlayCSS=a.extend({},a.blockUI.defaults.overlayCSS,d.overlayCSS||{}),f=a.extend({},a.blockUI.defaults.css,d.css||{}),d.onOverlayClick&&(d.overlayCSS.cursor="pointer"),o=a.extend({},a.blockUI.defaults.themedCSS,d.themedCSS||{}),q=void 0===q?d.message:q,p&&m&&c(window,{fadeOut:0}),q&&"string"!=typeof q&&(q.parentNode||q.jquery)){var r=q.jquery?q[0]:q,s={};a(b).data("blockUI.history",s),s.el=r,s.parent=r.parentNode,s.display=r.style.display,s.position=r.style.position,s.parent&&s.parent.removeChild(r)}a(b).data("blockUI.onUnblock",d.onUnblock);var t,s=d.baseZ;t=a(j||d.forceIframe?'<iframe class="blockUI" style="z-index:'+s++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+d.iframeSrc+'"></iframe>':'<div class="blockUI" style="display:none"></div>'),r=a(d.theme?'<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+s++ +';display:none"></div>':'<div class="blockUI blockOverlay" style="z-index:'+s++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),d.theme&&p?(s='<div class="blockUI '+d.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(s+10)+';display:none;position:fixed">',d.title&&(s+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(d.title||"&nbsp;")+"</div>"),s+='<div class="ui-widget-content ui-dialog-content"></div></div>'):d.theme?(s='<div class="blockUI '+d.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(s+10)+';display:none;position:absolute">',d.title&&(s+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(d.title||"&nbsp;")+"</div>"),s+='<div class="ui-widget-content ui-dialog-content"></div>',s+="</div>"):s=p?'<div class="blockUI '+d.blockMsgClass+' blockPage" style="z-index:'+(s+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+d.blockMsgClass+' blockElement" style="z-index:'+(s+10)+';display:none;position:absolute"></div>',s=a(s),q&&(d.theme?(s.css(o),s.addClass("ui-widget-content")):s.css(f)),d.theme||r.css(d.overlayCSS),r.css("position",p?"fixed":"absolute"),(j||d.forceIframe)&&t.css("opacity",0),f=[t,r,s];var u=a(p?"body":b);if(a.each(f,function(){this.appendTo(u)}),d.theme&&d.draggable&&a.fn.draggable&&s.draggable({handle:".ui-dialog-titlebar",cancel:"li"}),o=l&&(!a.support.boxModel||0<a("object,embed",p?null:b).length),k||o){if(p&&d.allowBodyStretch&&a.support.boxModel&&a("html,body").css("height","100%"),(k||!a.support.boxModel)&&!p){o=parseInt(a.css(b,"borderTopWidth"),10)||0;var v=parseInt(a.css(b,"borderLeftWidth"),10)||0,w=o?"(0 - "+o+")":0,x=v?"(0 - "+v+")":0}a.each(f,function(a,b){var c=b[0].style;if(c.position="absolute",2>a)p?c.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+d.quirksmodeOffsetHack+') + "px"'):c.setExpression("height",'this.parentNode.offsetHeight + "px"'),p?c.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):c.setExpression("width",'this.parentNode.offsetWidth + "px"'),x&&c.setExpression("left",x),w&&c.setExpression("top",w);else if(d.centerY)p&&c.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),c.marginTop=0;else if(!d.centerY&&p){var e="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+(d.css&&d.css.top?parseInt(d.css.top,10):0)+') + "px"';c.setExpression("top",e)}})}q&&(d.theme?s.find(".ui-widget-content").append(q):s.append(q),(q.jquery||q.nodeType)&&a(q).show()),(j||d.forceIframe)&&d.showOverlay&&t.show(),d.fadeIn?(f=d.onBlock?d.onBlock:i,t=d.showOverlay&&!q?f:i,f=q?f:i,d.showOverlay&&r._fadeIn(d.fadeIn,t),q&&s._fadeIn(d.fadeIn,f)):(d.showOverlay&&r.show(),q&&s.show(),d.onBlock&&d.onBlock()),e(1,b,d),p?(m=s[0],n=a(d.focusableElements,m),d.focusInput&&setTimeout(g,20)):h(s[0],d.centerX,d.centerY),d.timeout&&(q=setTimeout(function(){p?a.unblockUI(d):a(b).unblock(d)},d.timeout),a(b).data("blockUI.timeout",q))}}function c(b,c){var f,g=b==window,h=a(b),i=h.data("blockUI.history"),j=h.data("blockUI.timeout");j&&(clearTimeout(j),h.removeData("blockUI.timeout")),c=a.extend({},a.blockUI.defaults,c||{}),e(0,b,c),null===c.onUnblock&&(c.onUnblock=h.data("blockUI.onUnblock"),h.removeData("blockUI.onUnblock"));var k;k=g?a("body").children().filter(".blockUI").add("body > .blockUI"):h.find(">.blockUI"),c.cursorReset&&(1<k.length&&(k[1].style.cursor=c.cursorReset),2<k.length&&(k[2].style.cursor=c.cursorReset)),g&&(m=n=null),c.fadeOut?(f=k.length,k.stop().fadeOut(c.fadeOut,function(){0===--f&&d(k,i,c,b)})):d(k,i,c,b)}function d(b,c,d,e){var f=a(e);f.data("blockUI.isBlocked")||(b.each(function(a,b){this.parentNode&&this.parentNode.removeChild(this)}),c&&c.el&&(c.el.style.display=c.display,c.el.style.position=c.position,c.parent&&c.parent.appendChild(c.el),f.removeData("blockUI.history")),f.data("blockUI.static")&&f.css("position","static"),"function"==typeof d.onUnblock&&d.onUnblock(e,d),b=a(document.body),c=b.width(),d=b[0].style.width,b.width(c-1).width(c),b[0].style.width=d)}function e(b,c,d){var e=c==window;c=a(c),(b||(!e||m)&&(e||c.data("blockUI.isBlocked")))&&(c.data("blockUI.isBlocked",b),e&&d.bindEvents&&(!b||d.showOverlay)&&(b?a(document).bind("mousedown mouseup keydown keypress keyup touchstart touchend touchmove",d,f):a(document).unbind("mousedown mouseup keydown keypress keyup touchstart touchend touchmove",f)))}function f(b){if("keydown"===b.type&&b.keyCode&&9==b.keyCode&&m&&b.data.constrainTabKey){var c=n,d=b.shiftKey&&b.target===c[0];if(!b.shiftKey&&b.target===c[c.length-1]||d)return setTimeout(function(){g(d)},10),!1}var c=b.data,e=a(b.target);return e.hasClass("blockOverlay")&&c.onOverlayClick&&c.onOverlayClick(b),0<e.parents("div."+c.blockMsgClass).length?!0:0===e.parents().children().filter("div.blockUI").length}function g(a){n&&(a=n[!0===a?n.length-1:0])&&a.focus()}function h(b,c,d){var e=b.parentNode,f=b.style,g=(e.offsetWidth-b.offsetWidth)/2-(parseInt(a.css(e,"borderLeftWidth"),10)||0);b=(e.offsetHeight-b.offsetHeight)/2-(parseInt(a.css(e,"borderTopWidth"),10)||0),c&&(f.left=g>0?g+"px":"0"),d&&(f.top=b>0?b+"px":"0")}a.fn._fadeIn=a.fn.fadeIn;var i=a.noop||function(){},j=/MSIE/.test(navigator.userAgent),k=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent),l=a.isFunction(document.createElement("div").style.setExpression);a.blockUI=function(a){b(window,a)},a.unblockUI=function(a){c(window,a)},a.growlUI=function(b,c,d,e){var f=a('<div class="growlUI"></div>');b&&f.append("<h1>"+b+"</h1>"),c&&f.append("<h2>"+c+"</h2>"),void 0===d&&(d=3e3);var g=function(b){b=b||{},a.blockUI({message:f,fadeIn:"undefined"!=typeof b.fadeIn?b.fadeIn:700,fadeOut:"undefined"!=typeof b.fadeOut?b.fadeOut:1e3,timeout:"undefined"!=typeof b.timeout?b.timeout:d,centerY:!1,showOverlay:!1,onUnblock:e,css:a.blockUI.defaults.growlCSS})};g(),f.css("opacity"),f.mouseover(function(){g({fadeIn:0,timeout:3e4});var b=a(".blockMsg");b.stop(),b.fadeTo(300,1)}).mouseout(function(){a(".blockMsg").fadeOut(1e3)})},a.fn.block=function(c){if(this[0]===window)return a.blockUI(c),this;var d=a.extend({},a.blockUI.defaults,c||{});return this.each(function(){var b=a(this);d.ignoreIfBlocked&&b.data("blockUI.isBlocked")||b.unblock({fadeOut:0})}),this.each(function(){"static"==a.css(this,"position")&&(this.style.position="relative",a(this).data("blockUI.static",!0)),this.style.zoom=1,b(this,c)})},a.fn.unblock=function(b){return this[0]===window?(a.unblockUI(b),this):this.each(function(){c(this,b)})},a.blockUI.version=2.66,a.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var m=null,n=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],a):a(jQuery)}(),function($){function setAutocomplete(a){var b=this;a.each(function(){var a=$(this),c=a.data("ac-list-format"),d=a.data("ac-select-format"),e=getEntityByInput.call(b,a),f=getSuggestLinkByEntity.call(b,e);a.autocomplete({autoFocus:!0,source:function(d,g){var h=getRelatedDataByInput.call(b,a),i=$.extend({q:d.term},h);$.ajax({url:f,data:i,type:"post",dataType:"json",success:function(a){g(formatListData.call(b,a,e,c))}})},select:function(c,f){selectItem.call(b,a,c,f,e,d)},open:function(){openList.call(b,$(this))},close:function(){closeList.call(b,$(this))},minLength:2})})}function getRelatedDataByInput(a){var b=this,c=a.data("ac-related"),d=a.data("ac-related-data")||{},e="";return c&&$.isEmptyObject(d)&&($.each(c.toString().split(","),function(a,b){e+="[data-ac-related-id="+b+"],"}),$(e.replace(/,$/,""),b).each(function(){var a=$(this),b=a.data("ac-related-name")||a.attr("name");d[b]=parseInt(a.data("ac-item-id"))||a.val()}),a.data("ac-related-data",d)),d}function formatListData(data,acEntity,acListFormat){try{var formatFunc=eval("formatList"+acEntity.ucFirst()+"Item");$.map(data,function(a){return formatFunc(a,acListFormat)})}catch(e){}return data}function formatListCityItem(a,b){var c;switch(c=a.region+(a.area?a.region?" ("+a.area+")":a.area:""),c=(c?c+", ":"")+a.name,b){default:a.label=c,a.value=a.name;break;case"fullValue":a.label=c,a.value=c}return a}function formatListRegionItem(a,b){switch(b){default:a.label=(a.country?a.country+", ":"")+a.name,a.value=a.name}return a}function formatListStreetItem(a,b){switch(b){default:a.label=a.name,a.value=a.name}return a}function selectItem(a,b,c,d,e){setResultData.call(this,a,c.item.label,c.item.id)}function setResultData(a,b,c){var d=a.parent();a.data("ac-item-id",c||""),d.find($(settings(this).resultRawInput)).val(b||a.val()),d.find($(settings(this).resultIdInput)).val(c||""),c&&a.trigger("ac.select.id"),a.trigger("ac.select")}function getEntityByInput(a){return a.is(settings(this).acStreetInput)?"street":a.is(settings(this).acCityInput)?"city":a.is(settings(this).acRegionInput)?"region":a.is(settings(this).acCountryInput)?"country":""}function openList(a){}function closeList(a){}function getSuggestLinkByEntity(a){return settings(this)["suggest"+a.ucFirst()+"Link"]}function settings(a){return $.data(a,"vvAutocomplete")}$.vvAutocomplete={defaults:{acInput:".x-ac-input",acRelatedSelector:".x-ac-related",acStreetInput:"input.x-ac-street",acCityInput:"input.x-ac-city",acRegionInput:"input.x-ac-region",acCountryInput:"input.x-ac-country",resultRawInput:"input.x-ac-result-raw",resultIdInput:"input.x-ac-result-id",suggestCountryLink:"/location/suggest_country",suggestRegionLink:"/location/suggest_region",suggestCityLink:"/location/suggest_city",suggestStreetLink:"/location/suggest_street",clearCacheOnChange:!0}},$.fn.extend({vvAutocomplete:function(a){return this.each(function(){a=$.extend({},$.vvAutocomplete.defaults,a),$.data(this,"vvAutocomplete",a);var b=this;setAutocomplete.call(b,$(a.acInput,b)),$(a.acRelatedSelector,b).bind("change ac.select.id",function(){var b=$("[data-ac-related*="+$(this).data("ac-related-id")+"]");a.clearCacheOnChange&&b.data("ac-related-data",null).val("").trigger("change")}),$(a.acInput,b).change(function(){setResultData.call(b,$(this))})})}})}(jQuery),String.prototype.ucFirst=function(){var a=this;return a.length&&(a=a.charAt(0).toUpperCase()+a.slice(1)),a},function(a){function b(){a(".x-listing-navigation-form").ajaxForm({url:"/listing/get_orders_list",dataType:"json",beforeSubmit:function(b,c,d){a("#x-orders-list").block({message:"Подождите..."})},success:function(b){if(b.success){var c=a(b.view);c.vvListing(),a("#x-listing-container").html(c),a(".x-listing-navigation").vvListingNav()}else a("#x-orders-list").unblock()}})}a.vvListingNav={},a.fn.extend({vvListingNav:function(c){return this.each(function(){var c=this;a(c).on("change",".x-nav-count",function(){a("form",c).submit()}),a(c).on("click",".x-pages a",function(b){b.preventDefault(),a(".x-current-page",c).val(a(this).attr("data-page")),a("form",c).submit()}),b.call(this)})}})}(jQuery),function(a){function b(){a("input[type=checkbox]",this).prop("checked",!0),a("#x-listing-search-form").submit()}function c(b){a(".x-reset-marker",this).val(1),a("input[type=text]",this).val(""),a("input[type=radio]",this).attr("checked",!1),a("input[type=checkbox]",this).attr("checked",!1),b&&a("#x-listing-search-form").submit()}function d(){a(this).toggleClass("opened"),a(this).hasClass("opened")?(a(".x-opened-marker",this).val(1),a(".x-box-content",this).slideDown(400)):(a(".x-box-content",this).slideUp(400),a(".x-opened-marker",this).val(0))}a.vvListingBox={},a.fn.extend({vvListingBox:function(e){return this.each(function(){var e=this;a(".x-box-reset",this).click(function(){c.call(e,!0)}),a(".x-box-title",this).click(function(){d.call(e)}),a(".x-category-block",this).vvListingCategory(),a(".x-trunk-category-block",this).vvListingTrunks(),a(".x-box-select-all",this).click(function(){b.call(e)});var f=!1;a("input[type=checkbox]",this).change(function(){f&&clearTimeout(f),f=setTimeout(function(){a("#x-listing-search-form").submit()},1500)})})},vvListingBoxReset:function(a){return this.each(function(){c.call(this)})}})}(jQuery),function(a){function b(){f.call(this),a("input[type=text]",this).val(""),a("input[type=radio]",this).attr("checked",!1),a("input[type=checkbox]",this).attr("checked",!1)}function c(){var b=a(".x-box-config").vvGetListingConfig(),c={order_id:a(".x-order-id",this).val(),target_blank:b.target_blank?!0:!1},d=a(".x-box-btn");a.ajax({url:"/listing/get_order",type:"GET",data:c,traditional:!0,context:this,dataType:"json",success:function(a){if(!a.success)return void d.attr("href","#");var c=a.details.uri;d.attr("href",c),b.target_blank?d.attr("target","_blank"):d.attr("target","_self")},error:function(a,b,c){},complete:function(){}})}function d(){f.call(this);var b=this,c=a(".x-box-config").vvGetListingConfig(),d={order_id:a(".x-order-id",this).val(),target_blank:c.target_blank?!0:!1};a.ajax({url:"/listing/get_order",type:"GET",data:d,traditional:!0,context:this,dataType:"json",success:function(a){return a.success?void 0:void e.call(b,a.message)},error:function(a,b,c){},complete:function(){}})}function e(b){a(".x-box-error .x-error-msg").html(b),a(".x-box-error").removeClass("hidden")}function f(){a(".x-box-error").addClass("hidden"),a(".x-box-error .x-error-msg").html(null)}a.vvListingBoxOrderId={},a.fn.extend({vvListingBoxOrderId:function(e){return this.each(function(){var e=this;a(".x-order-id",this).on("input",function(){c.call(e)}),a(".x-box-config-tagert-blank").on("change",function(){c.call(e)}),a(".x-box-reset").on("click",function(){c.call(e)}),a(".x-box-btn",this).on("click",function(){d.call(e)}),a(".x-box-reset-order-id",this).on("click",function(){b.call(e)}),a(".x-order-id",this).on("keypress",function(a){13==a.which&&a.preventDefault()})})},vvListingBoxOrderIdReset:function(a){return this.each(function(){b.call(this)})}})}(jQuery),function(a){function b(){var b={avito:a(".x-box-config-avito",this).is(":checked"),slando:a(".x-box-config-slando",this).is(":checked"),target_blank:a(".x-box-config-tagert-blank",this).is(":checked"),only_urgent:a(".x-box-config-only-urgent",this).is(":checked"),orders_no_bid:a(".x-box-config-tagert-orders-no-bid",this).is(":checked")};return b}function c(){var b=a("#x-box-config-save-search-block"),c=a(this).closest("div"),d=300;b.block({message:""}),a(c).fadeOut(d),setTimeout(function(){c.hide(),a("#x-box-config-save-search-tmp-interface").show(),b.unblock()},d)}function d(){var b=a("#x-box-config-save-search-block"),c=a("#x-box-config-save-search-tmp-button").closest("div"),d=300;b.block({message:""}),a("#x-box-config-save-search-tmp-interface").fadeOut(d),setTimeout(function(){a("#x-box-config-save-search-tmp-interface").hide(),c.show(),b.unblock()},d)}function e(){a.ajax({data:{name:a("#x-box-config-search-tmp-name").val()},beforeSend:function(){a("#x-box-config-save-search-block").block({message:""}),a("#x-box-listing-tmp-block").block({message:""})},url:site_url("listing/save_search_tmp"),dataType:"json",type:"POST",success:function(b){if(a("#x-box-config-save-search-block").unblock(),a("#x-box-listing-tmp-block").unblock(),1===b.success)g.call(this,b),f.call(this),d.call(this);else for(var c in b.message)a("#x-box-tmp-error-message").html(b.message[c])}})}function f(){a("#x-box-remove-tmp-block").show()}function g(b){a("#x-box-listing-tmp-select").html(b.tmpView)}a.vvListingBoxConfig={},a.fn.extend({vvListingBoxConfig:function(b){return this.each(function(){a("#x-box-config-save-search-tmp-button").on("click",function(){c.call(this)}),a("#x-box-config-save-search-tmp-interface-button").on("click",function(){e.call(this)})})},vvGetListingConfig:function(){return b.call(this)}})}(jQuery),function(a){function b(){a.ajax({data:{id:a(this).val()},beforeSend:function(){a("#x-box-config-save-search-block").block({message:""}),a("#x-box-listing-tmp-block").block({message:""})},url:site_url("listing/load_search_tmp"),dataType:"json",type:"POST",success:function(b){if(a("#x-box-config-save-search-block").unblock(),a("#x-box-listing-tmp-block").unblock(),1===b.success)window.location=site_url("listing");else{a("#x-box-remove-tmp-block").hide();for(var c in b.message)a("#x-box-tmp-error-message").html(b.message[c])}}})}function c(){a.ajax({data:{id:a(this).val()},beforeSend:function(){a("#x-box-config-save-search-block").block({message:""}),a("#x-box-listing-tmp-block").block({message:""})},url:site_url("listing/remove_search_tmp"),dataType:"json",type:"POST",success:function(b){if(a("#x-box-config-save-search-block").unblock(),a("#x-box-listing-tmp-block").unblock(),1===b.success)a("#x-box-listing-tmp-select option:selected").remove(),a("#x-box-remove-tmp-block").hide(),a(".x-reset-all").trigger("click");else for(var c in b.message)a("#x-box-tmp-error-message").html(b.message[c])}})}a.vvListingBoxTmp={},a.fn.extend({vvListingBoxTmp:function(d){return this.each(function(){var d=this;a(this).on("change",function(){b.call(this)}),a("#x-box-remove-tmp").on("click",function(){confirm("Удалить шаблон поиска ?")&&c.call(d)})})}})}(jQuery),function(a){function b(){var b=c.call(this,a(".x-category-chk"));b.length>0?a(".x-category-serialized",this).val(a.base64.encode(b.join(","))):a(".x-category-serialized",this).val("");var d=c.call(this,a(".x-subcategory-chk"));d.length>0?a(".x-subcategory-serialized",this).val(a.base64.encode(d.join(","))):a(".x-subcategory-serialized",this).val("")}function c(b){var c=[];return b.each(function(b,d){a(d).is(":checked")&&c.push(a(d).val())}),c}a.vvListingBoxCategory={},a.fn.extend({vvListingBoxCategory:function(c){return this.each(function(){var c=this;a("#x-listing-search-form").submit(function(){b.call(c)})})}})}(jQuery),function(a){function b(){a(".x-category-chk",this).is(":checked")?a(".x-subcategory-chk",this).prop("checked",!0):a(".x-subcategory-chk",this).prop("checked",!1)}function c(b){var c=b.parents(".x-category-block"),d=!1;a(".x-subcategory-chk",c).each(function(b,e){return a(e).is(":checked")?(d=!0,a(".x-category-chk",c).prop("checked",1),!1):!0}),d||a(".x-category-chk",c).removeAttr("checked")}function d(){(a(this).hasClass("closed")||a(this).hasClass("opened"))&&(a(this).toggleClass("closed").toggleClass("opened"),a(this).hasClass("opened")?a(".x-subcategories",this).slideDown(400):a(".x-subcategories",this).slideUp(400))}a.vvListingCategory={},a.fn.extend({vvListingCategory:function(e){return this.each(function(){var e=this;a(".x-category-title",this).click(function(){d.call(e)}),a(".x-category-chk",this).click(function(a){a.stopPropagation()}),a(".x-category-chk",this).change(function(){b.call(e)}),a(".x-subcategory-chk",this).change(function(){c.call(e,a(this))})})}})}(jQuery),function(a){function b(){a(".x-listing-country-selector",this).vvListingCountrySelectorReset()}a.vvListingBoxRoute={},a.fn.extend({vvListingBoxRoute:function(c){return this.each(function(){var c=this;a(".x-locator",this).vvLocator(),a(".x-listing-country-selector",this).vvListingCountrySelector(),a(".x-box-reset-route",this).click(function(){b.call(c)})})},vvListingBoxRouteReset:function(a){return this.each(function(){b.call(this)})}})}(jQuery),function(a){function b(){a(".x-listing-country-selector",this).vvListingCountrySelectorReset()}a.vvListingBoxOrigin={},a.fn.extend({vvListingBoxOrigin:function(c){return this.each(function(){var c=this;a(".x-locator",this).vvLocator(),a(".x-listing-country-selector",this).vvListingCountrySelector(),a(".x-box-reset-origin",this).click(function(){b.call(c)})})},
vvListingBoxOriginReset:function(a){return this.each(function(){b.call(this)})}})}(jQuery),function(a){function b(){0==a(".x-country-select",this).val()&&(a(".x-country-select",this).val(1),f.call(this))}function c(){a(".x-selected-country",this).hasClass("hidden")?e.call(this):d.call(this)}function d(){a(".x-selected-country",this).addClass("hidden"),a(".x-country-select",this).removeClass("hidden"),a(".x-country-select",this).focus()}function e(){a(".x-selected-country",this).removeClass("hidden"),a(".x-selected-country-img",this).removeClass("hidden"),a(".x-country-select",this).addClass("hidden")}function f(){var b=parseInt(a(".x-country-select",this).val());if(!b)return a(".x-selected-country-title",this).html("выбрать"),void a(".x-selected-country-img",this).removeAttr("src");var c=null,d=get_countries();if(a.each(d,function(a,d){return d.id==b?(c=d,!1):!0}),a(".x-selected-country-title",this).html(c.name),c.iso){var e="/assets/styles/images/flags/"+c.iso.toLowerCase()+".png";a(".x-selected-country-img",this).attr("src",e)}}function g(){a(".x-country-select",this).val(0),a(".x-selected-country-title",this).html("выбрать"),a(".x-selected-country-img",this).removeAttr("src"),a(".x-selected-country-img",this).addClass("hidden"),a(".x-selected-country",this).removeClass("hidden"),a(".x-country-select",this).addClass("hidden")}a.vvListingCountrySelector={},a.fn.extend({vvListingCountrySelector:function(d){return this.each(function(){var d=this;a(".x-selected-country",this).click(function(){c.call(d),b.call(d)}),a(".x-country-select",this).change(function(){c.call(d),f.call(d)}),a(".x-country-select",this).blur(function(){e.call(d)})})},vvListingCountrySelect:function(){return this.each(function(){f.call(this),e.call(this)})},vvListingCountrySelectorReset:function(){return this.each(function(){g.call(this)})}})}(jQuery),function(a){function b(){var b=this;f.call(b),a("input[name=search-weight-from]",b).val(""),a("input[name=search-weight-to]",b).val("")}function c(b){var c=a("#x-listing-search-form"),d=a("input[name=search-weight-from]",b),e=0;d.on("blur",function(){var a=parseFloat(d.val().replace(",","."));""!==a&&e>a?d.val(e):d.val(a.toString())}),c.on("submit",function(){d.val(parseFloat(d.val().replace(",","."))),d.trigger("blur")})}function d(b){var c=a("#x-listing-search-form"),d=a("input[name=search-weight-to]",b),e=a("input[name=search-weight-from]",b);d.on("blur",function(){var a=parseFloat(d.val().replace(",",".")),b=parseFloat(e.val().replace(",","."));""!==a&&b>a?d.val(b.toString()):d.val(a.toString())}),c.on("submit",function(){var a=parseFloat(d.val().replace(",","."));d.val(a),d.trigger("blur")})}function e(b){var c="";a.each(b,function(a,b){c+=b+"<br>"}),a(".x-box-weight-error .x-error-msg").html(c),a(".x-box-weight-error").removeClass("hidden")}function f(){a(".x-box-weight-error").addClass("hidden"),a(".x-box-weight-error .x-error-msg").html(null)}a.vvListingBoxWeight={},a.fn.extend({vvListingBoxWeight:function(e){return this.each(function(){var e=this;a(".x-box-reset-weight",this).on("click",function(){b.call(e)}),a("#x-box-search-weight-btn").click(function(){var b=a("#x-listing-search-form");b.submit()}),c.call(e),d.call(e)})},vvListingBoxWeightReset:function(a){return this.each(function(){b.call(this)})},vvListingBoxWeightSetErrors:function(a){return this.each(function(){e(a.message)})}})}(jQuery),function(a){function b(){var b=c.call(this,a(".x-trunkType"));b.length>0?a(".x-trunks-serialized",this).val(a.base64.encode(b.join(","))):a(".x-trunks-serialized",this).val("");var d=c.call(this,a(".x-trunkCategoryType"));d.length>0?a(".x-trunks-categories-serialized",this).val(a.base64.encode(d.join(","))):a(".x-trunks-categories-serialized",this).val("")}function c(b){var c=[];return b.each(function(b,d){a(d).is(":checked")&&c.push(a(d).val())}),c}a.vvListingBoxTrunks={},a.fn.extend({vvListingBoxTrunks:function(c){return this.each(function(){var c=this;a("#x-listing-search-form").submit(function(){b.call(c)})})}})}(jQuery),function(a){function b(){a(".x-trunk-category-chk",this).prop("checked")?a(".x-trunk-subcategory-chk",this).prop("checked",!0):a(".x-trunk-subcategory-chk",this).prop("checked",!1)}function c(b){var c=b.parents(".x-trunk-category-block"),d=!1;a(".x-trunk-subcategory-chk",c).each(function(b,e){return a(e).prop("checked")?(d=!0,a(".x-trunk-category-chk",c).prop("checked",!0),!1):!0}),d||a(".x-trunk-category-chk",c).removeAttr("checked")}function d(){(a(this).hasClass("closed")||a(this).hasClass("opened"))&&(a(this).toggleClass("closed").toggleClass("opened"),a(this).hasClass("opened")?a(".x-subcategories",this).slideDown(400):a(".x-subcategories",this).slideUp(400))}function e(b){f.call(this);var c=a(".x-search-trunk-types",b);c.val(0).multiselect("rebuild")}function f(){a(".x-box-trunk-error").addClass("hidden"),a(".x-box-trunk-error .x-error-msg").html(null)}a.vvListingTrunks={},a.fn.extend({vvListingTrunks:function(f){return this.each(function(){var f=this;a(".x-box-reset-trunk",this).on("click",function(){e.call(f)}),a(".x-trunk-category-title",this).click(function(){d.call(f)}),a(".x-trunk-category-chk",this).click(function(a){a.stopPropagation()}),a(".x-trunk-category-chk",this).change(function(){b.call(f)}),a(".x-trunk-subcategory-chk",this).change(function(){c.call(f,a(this))})})},vvListingBoxTrunkReset:function(a){return this.each(function(){e.call(this)})}})}(jQuery),function(a){function b(){var b=a(this).data("id");a("#x-order-info-"+b,this).trigger("open-detail")}a.vvListing={},a.fn.extend({vvListing:function(c){return this.each(function(){var c=this;a(c).on("click","a.x-order-link",function(){b.call(this)}),a(c).on("open-detail","a.x-order-link",function(){var b=a(".x-box-config").vvGetListingConfig();return b.target_blank?(a(this).attr("target","_blank"),window.open(a(this).attr("href"),"_blank"),!0):void(window.location=a(this).attr("href"))}),a(c).on("click",".x-order-fake-link",function(a){a.preventDefault(),b.call(this)})})}})}(jQuery),function(a){function b(){var b=this;a("#x-listing-search-form").ajaxForm({url:"/listing/get_orders_list",dataType:"json",beforeSubmit:function(d,e,f){c.call(b),a("#x-listing-container").block({message:"Подождите..."})},success:function(c){if(c.success){var d=a(c.view);d.vvListing(),a("#x-listing-container").html(d),a(".x-listing-navigation").vvListingNav(),a(".x-reset-marker",b).val(0),a("#map").trigger("update_points",[c.orders?c.orders:[]])}else{a("#x-listing-container").unblock();var e=a(".x-listing-box.x-box-weight");e.vvListingBoxWeightSetErrors(c)}}})}function c(){a(".x-box-error",this).addClass("hidden"),a(".x-box-error .x-error-msg",this).html(null)}function d(){a(".x-listing-box").vvListingBoxReset(),a(".x-listing-box.x-box-order-id").vvListingBoxOrderIdReset(),a(".x-listing-box.x-box-route").vvListingBoxRouteReset(),a(".x-listing-box.x-box-origin").vvListingBoxOriginReset(),a(".x-listing-box.x-box-weight").vvListingBoxWeightReset(),a(".x-listing-box.x-box-trunk").vvListingBoxTrunkReset(),a("#x-box-listing-tmp-select option:selected").removeAttr("selected"),a("#x-box-remove-tmp-block").hide(),a("#x-listing-search-form").submit()}a.vvListingFilter={},a.fn.extend({vvListingFilter:function(c){return this.each(function(){var c=this;a(".x-reset-all",this).click(function(){d.call(c)}),b.call(this)})},vvListingFilterReset:function(a){return this.each(function(){d.call(this)})}})}(jQuery),"undefined"==typeof Number.prototype.toRad&&(Number.prototype.toRad=function(){return this*Math.PI/180});var lib={utils:{distance:function(a,b,c,d){var e=6371e3,f=new Number(c-a).toRad(),g=new Number(d-b).toRad();a=new Number(a).toRad(),c=new Number(c).toRad();var h=Math.sin(f/2)*Math.sin(f/2)+Math.sin(g/2)*Math.sin(g/2)*Math.cos(a)*Math.cos(c),i=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h));return e*i},pathToPoints:function(a,b){var c=[];return a.each(function(a,d){var e=a.getSegments();for(var f in e)if(e.hasOwnProperty(f)){var g=e[f].getCoordinates();for(var d in g)g.hasOwnProperty(d)&&(0!=d||0==f)&&(c.length>0&&lib.utils.distance(c[c.length-1][0],c[c.length-1][1],g[d][0],g[d][1])<b||c.push(g[d]))}}),c}}};"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var ListingMap={_enable:1,preserve_objects:0,_preserve_timer:null,map:null,markers:[],map_id:"map",last_orders:[],last_route:null,mode_center:1,mode_last:2,mode_first:3,zoomLimit:5,zoom_type_district:1,zoom_type_region:2,zoom_type_city:3,zoom_type_none:4,cluster_informer_timer:null,searches:[],search_type:null,search_form:null,geo_area:null,back_search:null,routeHumanLength:null,cities:[],clusters:[],routeForceUpdate:0,displayedItems:[],categories:{category_1:"Мебель и бытовая техника",category_2:"Переезд",category_3:"Строительные грузы и оборудование",category_4:"Вывоз мусора",category_7:"Транспортные средства",category_8:"Перевозка живтоных",category_9:"Пассажирские перевозки",category_10:"Продукты питания",category_11:"Догруз",category_12:"Прочие грузы"},getZoomType:function(){var a=this.map.getZoom();return 5>a?this.zoom_type_district:8>a?this.zoom_type_region:11>a?this.zoom_type_city:this.zoom_type_none},zoomNext:function(){var a=this.map.getZoom();5>a?a=5:8>a?a=8:11>a&&(a=11),this.map.setZoom(a)},init:function(){var a=this;this.map=new ymaps.Map("map",{center:[55,63],zoom:4}),this.map.controls.add(new ymaps.control.ZoomControl);var b=$("#map_switch").prop("checked");if($("#map_switch").prop("checked",b),$("#map_switch").change(function(){$(this).prop("checked")?($.cookie("map_switch",1,{expires:30,path:"/"}),a.enable()):($.cookie("map_switch",0,{expires:30,path:"/"}),a.disable())}),$("#map_switch").is(":checked")?a.enable():a.disable(),$("#"+this.map_id).on("update_points",function(b,c){a.updateOrders(c)}),ymaps.layout.storage.add("vv#markerBalloonLayout",ymaps.templateLayoutFactory.createClass('<div class="m-vip3" style="top:-280px;left: -150px;"><div class="fon-top"></div>$[properties.body]<div class="fon-bottom"></div></div>')),ymaps.layout.storage.add("vv#multyBalloonLayout",ymaps.templateLayoutFactory.createClass(ListingMap.MultyWindow)),this.map.options.set({balloonShadow:!1,preset:"twirl#blueStretchyIcon"}),$(".searchBut").click(function(){if(!a._enable)return!0;var b=$(this).closest("form"),c=$(this).data("type");return"route"==c?a.updateRoute(function(){b.submit()}):"origin"==c&&a.updateOriginCircle(function(){b.submit()}),!1}),$("#origin_center_lat").val()&&$("#origin_center_lng").val()?$("#x-box-search-origin").trigger("click"):$("#route_points").val()&&$("#x-box-search-route").trigger("click"),$("#map_switch:checked").length){this.clear();var c=$('.x-box-origin input[type="text"]').filter(function(){return!!this.value}).length,d=$('.x-box-route input[type="text"]').filter(function(){return!!this.value}).length;c||d||$("#x-listing-search-form").submit()}$(".x-box-reset-route").click(function(){return $("#route_points").val(""),$("select[name=route_deviation]").val(100),$("select[name=city_route_1], select[name=city_route_2]").data("ac-related-data",null),ListingMap.clear(),ListingMap.resetScaleAndPosition(),ListingMap.toggleBackSearch("results"),ListingMap.clusterInformerHide(),!1}),$(".x-box-reset-origin").click(function(){return $("#route_points").val(""),$("select[name=origin_deviation]").val(100),$("input[name=city_origin_1]").data("ac-related-data",null),ListingMap.clear(),ListingMap.resetScaleAndPosition(),ListingMap.toggleBackSearch("results"),ListingMap.clusterInformerHide(),!1}),$(document).on("click",".x-reset-no-result, .x-reset-all",function(){return $("#route_points").val(""),$("select[name=route_deviation], select[name=origin_deviation]").val(100),$("input[name=city_origin_1], select[name=city_route_1], select[name=city_route_2]").data("ac-related-data",null),ListingMap.clear(),ListingMap.resetScaleAndPosition(),ListingMap.toggleBackSearch("results"),ListingMap.clusterInformerHide(),!1}),$(document).on("click","a.city_selector",function(){var b=($(this).data("city_id"),$(this).data("lat")),c=$(this).data("lng");return b&&c&&(a.map.setCenter([b,c]),a.map.setZoom(10)),!1}),$(document).on("click","#back_search",function(){return a.toggleBackSearch("results"),location.hash="",$("#x-listing-search-form").submit(),!1}),$(document).on("click","#show_multy_results",function(){return a.toggleBackSearch("search"),location.hash="#x-listing-container",$("#x-listing-search-form").submit(),!1}),$(document).on("click",".m-close",function(){return ListingMap.map.balloon.close(),ListingMap.setLimitOrders([]),!1}),this.routeForceUpdate&&$("button[data-type=route]").click(),$_GET.click_route_search&&$(".searchBut").trigger("click")},resetScaleAndPosition:function(){this.map.setCenter([55,63]),this.map.setZoom(4)},toggleBackSearch:function(a){"search"==a?($("#search_params_widget").hide(),$("#back_search").show()):"results"==a&&(ListingMap.setLimitOrders([]),$("#search_params_widget").show(),$("#back_search").hide())},clear:function(){var a=this;this.map.geoObjects.each(function(b){a.map.geoObjects.remove(b)}),a.updateRouteInfo(null),this.markers=[],this.displayedItems=[]},removeMarkers:function(a){a=!!a;for(var b in this.markers)if(this.markers.hasOwnProperty(b))if(a){var c=ListingMap.markers[b].geometry.getCoordinates();this.isDisplayedOnCurrentView(c[0],c[1])||(this.map.geoObjects.remove(this.markers[b]),this.freeCoordinates(c[0],c[1]),delete this.markers[b])}else this.map.geoObjects.remove(this.markers[b]);a||(this.displayedItems=[],this.markers=[])},clustering:function(a){var b=[],c=[],d=this.getZoomType(),e=null,f=!1;this.cities=[];for(var g in a)if(a.hasOwnProperty(g)){if(f=!1,a[g].from){if(d==ListingMap.zoom_type_district)if(this.Regions[a[g].from.reg])e=this.Regions[a[g].from.reg].district;else{if(1==a[g].from.country)continue;e="country:"+a[g].from.country}else if(d==ListingMap.zoom_type_region)if(this.Regions[a[g].from.reg])e=a[g].from.reg;else if(a[g].from.city)e="city:"+a[g].from.city;else{if(1==a[g].from.country)continue;e="country:"+a[g].from.country}else d==ListingMap.zoom_type_city&&a[g].from.city?e="city:"+a[g].from.city:(e="multy:"+a[g].from.lat+"|"+a[g].from.lng,c[e]||(c[e]={lat:a[g].from.lat,lng:a[g].from.lng,items:[]}),c[e].items.push($.extend({},a[g],{point:1})),f=!0);f||(b[e]||(b[e]=[]),b[e].push($.extend({},a[g],{point:1}))),a[g].from.city&&(this.cities[a[g].from.city]?(this.cities[a[g].from.city].orders_count++,this.cities[a[g].from.city].orders.push(a[g].id)):this.cities[a[g].from.city]={name:a[g].from.cn,orders:[a[g].id],orders_count:1,lat:a[g].from.lat,lng:a[g].from.lng})}if(f=!1,a[g].to){if(d==ListingMap.zoom_type_district)if(this.Regions[a[g].to.reg])e=this.Regions[a[g].to.reg].district;else{if(1==a[g].to.country)continue;e="country:"+a[g].to.country}else if(d==ListingMap.zoom_type_region)if(this.Regions[a[g].to.reg])e=a[g].to.reg;else if(a[g].to.city)e="city:"+a[g].to.city;else{if(1==a[g].to.country)continue;e="country:"+a[g].to.country}else d==ListingMap.zoom_type_city&&a[g].to.city?e="city:"+a[g].to.city:(e="multy:"+a[g].to.lat+"|"+a[g].to.lng,c[e]||(c[e]={lat:a[g].to.lat,lng:a[g].to.lng,items:[]}),c[e].items.push($.extend({},a[g],{point:2})),f=!0);f||(b[e]||(b[e]=[]),b[e].push($.extend({},a[g],{point:2}))),a[g].to.city&&(this.cities[a[g].to.city]?this.cities[a[g].to.city].orders.push(a[g].id):this.cities[a[g].to.city]={name:a[g].to.cn,orders:[a[g].id],orders_count:0})}}var h=this.clusterDistances[this.map.getZoom()];for(g in c)if(c.hasOwnProperty(g))for(var i in c)if(c.hasOwnProperty(i)&&g!=i&&lib.utils.distance(c[g].lat,c[g].lng,c[i].lat,c[i].lng)<h){c[i].lat=(parseFloat(c[i].lat)+parseFloat(c[g].lat))/2,c[i].lng=(parseFloat(c[i].lng)+parseFloat(c[g].lng))/2,c[i].items=c[i].items.concat(c[g].items),delete c[g];break}for(g in c)c.hasOwnProperty(g)&&(b[g]=c[g].items);return b},calculateCenterCity:function(a){if(!this.cities[a].lat||this.cities[a].lng){for(var b=0,c=0,d=0,e=0,f=0,g=0;g<this.last_orders.length;g++)this.last_orders[g].from.city==a&&(e=parseFloat(this.last_orders[g].from.lat),f=parseFloat(this.last_orders[g].from.lng),isNaN(e)||isNaN(f)||(b+=e,c+=f,d++)),this.last_orders[g].to.city==a&&(e=parseFloat(this.last_orders[g].to.lat),f=parseFloat(this.last_orders[g].to.lng),!isNaN(e)&&!isNaN(f)&&e&&f&&(b+=e,c+=f,d++));if(0==d)return null;this.cities[a].lat=b/d,this.cities[a].lng=c/d}return{lat:this.cities[a].lat,lng:this.cities[a].lng}},updateOrders:function(a,b){if(!this._enable)return!1;a="object"==typeof a&&null!=a?this.last_orders=a:this.last_orders,b=!!b;var c=this.getRouteAddresses();this.updateRouteInfo({from:c.from,to:c.to,distance:this.routeHumanLength,deviation:this.getRouteRadius(),ordersFound:a.length}),this.removeMarkers(b);this.clustering(a.info);zt=this.getZoomType(),country=null,city=null,this.updateRightCities(a.most_popular);var d=[];this.map.geoObjects.each(function(a){("objectManager_load"==a.properties.get("key")||"objectManager_to"===a.properties.get("key"))&&d.push(a)});for(var e=0;e<d.length;e++)this.map.geoObjects.remove(d[e]);var f=new ymaps.ObjectManager({clusterize:!0,gridSize:64,clusterBalloonLeftColumnWidth:140});f.objects.options.set("preset","islands#darkGreenIcon"),f.clusters.options.set("preset","islands#greenClusterIcons"),f.properties.set("key","objectManager_load"),f.add(a.from),this.map.geoObjects.add(f);var g=new ymaps.ObjectManager({clusterize:!0,gridSize:64,clusterBalloonLeftColumnWidth:140});g.objects.options.set("preset","islands#redIcon"),g.clusters.options.set("preset","islands#redClusterIcons"),g.properties.set("key","objectManager_to"),g.add(a.to),this.map.geoObjects.add(g)},isDisplayedOnCurrentView:function(a,b){var c=this.map.getBounds();if(ListingMap.map.getZoom()<2)return!0;var d=0;c[1][1]<c[0][1]&&(d=180+c[1][1],c[0][1]=c[0][1]-d,c[1][1]=180),b-=d;var e=.1*(c[1][0]-c[0][0]),f=.1*(c[1][1]-c[0][1]);return a>c[0][0]-e&&a<c[1][0]+e&&b>c[0][1]-f&&b<c[1][1]+f},_roundCoordinate:function(a){return Math.round(1e5*a)/1e5},isOnMap:function(a,b){var c=this._roundCoordinate(a)+this._roundCoordinate(b);return!!this.displayedItems[c]},takeCoordinates:function(a,b){var c=this._roundCoordinate(a)+this._roundCoordinate(b);this.displayedItems[c]=!0},freeCoordinates:function(a,b){var c=this._roundCoordinate(a)+this._roundCoordinate(b);this.displayedItems[c]=null},markerClick:function(a){ListingMap.preserveObjects();var b=a.get("target"),c=b.getMap(),d=(c.getBounds(),b.properties.get("name")),e=a.get("coordPosition");$.ajax("/listing/get_order_info",{dataType:"json",data:{order_id:d},type:"post",success:function(a){a.success?(ListingMap.preserveObjects(),b.properties.set("body",a.content),ListingMap.map.setCenter(e)):alert(a.message)}})},preserveObjects:function(){ListingMap.preserve_objects=1,null!==this._preserve_timer&&clearTimeout(this._preserve_timer),this._preserve_timer=setTimeout(function(){ListingMap.preserve_objects=0,this._preserve_timer=null},4e3)},clusterClick:function(a){var b=a.get("target"),c=b.properties.get("multy");if(ListingMap.clusterInformerHide(),c){ListingMap.preserveObjects();for(var d=b.properties.get("items"),e=[],f=0;f<d.length;f++)e.push(d[f].id);ListingMap.setLimitOrders(e),ListingMap.map.setCenter(a.get("coordPosition"))}else ListingMap.clusterInformerHide(),b.options.set("hasBalloon",!1),ListingMap.map.setCenter(a.get("coordPosition")),ListingMap.zoomNext()},setLimitOrders:function(a){$("#limit_orders").val(JSON.stringify(a))},getLimitOrders:function(){return JSON.parse($("#limit_orders").val())},clusterShowInfo:function(a){var b=a.get("target");ListingMap.clusterInformerShow(b.properties.get("loading"),b.properties.get("unloading"))},clusterHideInfo:function(a){ListingMap.clusterInformerHide()},scaleDistances:[5e5,4e5,2e5,1e5,1e5,1e5,8e4,6e4,3e4,2e4,1e4,5e3,500,100,50,50,50,50],guessZoom:function(a){return zoom_lvl=10,24576>a&&(zoom_lvl=1),12288>a&&(zoom_lvl=2),6144>a&&(zoom_lvl=3),3072>a&&(zoom_lvl=4),1536>a&&(zoom_lvl=5),768>a&&(zoom_lvl=6),384>a&&(zoom_lvl=7),192>a&&(zoom_lvl=8),96>a&&(zoom_lvl=9),48>a&&(zoom_lvl=10),24>a&&(zoom_lvl=11),11>a&&(zoom_lvl=12),4.8>a&&(zoom_lvl=13),3.2>a&&(zoom_lvl=14),1.6>a&&(zoom_lvl=15),.8>a&&(zoom_lvl=16),.3>a&&(zoom_lvl=17),zoom_lvl},clusterDistances:{10:15e3,11:3e3,12:1500,13:750,14:500,15:400,16:300,17:200},updateOriginCircle:function(a){var b=this,c=$(".x-selected-country-title").html();"выбрать"==c&&(c="");var d="",e=!1;$("input[name=city_origin_1]").val()&&(d=$("input[name=city_origin_1]").val()),$("input[name=region_origin_1]").val()&&(d=$("input[name=region_origin_1]").val()+", "+d),d.length>0&&c.length>0&&(d=c+", "+d),d.length<=0&&c.length>0&&(d=$("select[name=country_origin_1] option:selected").attr("data-capital-coordinates"),e=!0);var f=$("select[name=origin_deviation]").val(),g={50:7,100:6,200:5,300:4,"-1":5};this.clear(),e?$.ajax("/listing/get_area_polygon",{dataType:"json",data:{entity_id:$("select[name=country_origin_1] option:selected").val(),type:"country"},type:"get",success:function(c){if(1==c.success){var d=new ymaps.GeoObjectCollection;for(i in c.polygons){var e=new ymaps.Polygon([c.polygons[i]],{},{opacity:.7,fill:1,outline:1,strokeWidth:2,zIndex:1});d.add(e)}ListingMap.geo_area=d,ListingMap.map.geoObjects.add(d);var f=d.getBounds();ListingMap.map.setBounds(f,{checkZoomRange:!0}),$.isFunction(a)&&a.call(b)}}}):!e&&d.length>0?ymaps.geocode(d).then(function(c){if(c&&c.geoObjects){var d=c.geoObjects.get(0);if(d){var e=d.geometry.getCoordinates();if($("#origin_center_lat").val(e[0]),$("#origin_center_lng").val(e[1]),$.isFunction(a)&&a.call(b),f>0){var h=new ymaps.Circle([e,1e3*f]);ListingMap.map.geoObjects.add(h),ListingMap.geo_area=h}ListingMap.map.setCenter(e),ListingMap.map.setZoom(g[f]?g[f]:4)}}}):$.isFunction(a)&&a.call(b)},getRouteAddresses:function(){return{from:$.trim($("input[name=region_route_1]").val()+" "+$("input[name=city_route_1]").val()),to:$.trim($("input[name=region_route_2]").val()+" "+$("input[name=city_route_2]").val())}},updateRouteInfo:function(a){var b=$("#route_info");null!=a&&a.from&&a.to?(b.find(".route_from").html(a.from),b.find(".route_to").html(a.to),b.find(".route_distance").html(a.distance),a.deviation>0?(b.find(".route_deviation").closest("span.tpl").show(),b.find(".route_deviation").html(a.deviation)):b.find(".route_deviation").closest("span.tpl").hide(),b.find(".route_orders_found").html(a.ordersFound),b.show()):b.hide()},updateRightCities:function(a){$("#cities").empty(),this.cities=a;for(k in a)a.hasOwnProperty(k)&&$("#cities").append($('<li><a class="city_selector" data-lat="'+a[k].lat+'" data-lng="'+a[k].lng+'" data-city_id="'+a[k].id+'" href="#"><span>'+a[k].name+"</span> ("+a[k].count+")</a></li>"))},updateCategoriesWidget:function(){var a=this,b=[],c=[];$(".categoryNav .x-category-chk").each(function(){var d='<li><a href="#">'+a.categories[$(this).attr("id")]+"</a></li>";$(this).is(":checked")?b.push(d):c.push(d)}),b.length>5?0==c.length?($("#all").show(),$("#except").hide()):($("#except").show(),$("#seleced_categories").html(c.join(""))):($("#all").hide(),$("#except").hide(),$("#seleced_categories").html(b.join("")))},getRouteRadius:function(){return $("select[name=route_deviation]").val()},getRouteCoutry:function(a){var b=null;if("from"==a&&(b="select[name=country_route_1]"),"to"==a&&(b="select[name=country_route_2]"),!b)return null;var c=$(b+" option:selected").attr("data-capital-coordinates");return $.trim(c)},updateRoute:function(a){var b=this,c=this.getRouteAddresses();return c.from||(c.from=b.getRouteCoutry("from")),c.to||(c.to=b.getRouteCoutry("to")),c.from&&c.to?null!==b.last_route&&c.from==b.last_route.from&&c.to==b.last_route.to&&b.getRouteRadius()==b.last_route.deviation?($.isFunction(a)&&a.call(this),!1):(c.deviation=b.getRouteRadius(),b.last_route=c,b.loading(1),ymaps.route([{type:"wayPoint",point:c.from},{type:"wayPoint",point:c.to}],{mapStateAutoApply:!0}).then(function(c){var d=c.getWayPoints();b.routeHumanLength=c.getHumanLength(),d.get(0).properties.set("iconContent",""),d.get(0).options.set("iconImageHref","/assets/images/v2/map/A.png"),d.get(0).options.set("iconImageSize",[43,48]),d.get(0).options.set("iconImageOffset",[-10,-48]),d.get(0).options.set("geoObjectZIndexHover",200),d.get(1).properties.set("iconContent",""),d.get(1).options.set("iconImageHref","/assets/images/v2/map/B.png"),d.get(1).options.set("iconImageSize",[43,48]),d.get(1).options.set("iconImageOffset",[-10,-48]),d.get(1).options.set("geoObjectZIndexHover",200),c.getPaths().options.set({strokeColor:"#69c"}),b.clear(),b.map.geoObjects.add(c);var e=c.getLength(),f=b.guessZoom(e/1e3)+1,g=Math.max(b.scaleDistances[f],1e3*$("select[name=route_deviation]").val()/4),h=lib.utils.pathToPoints(c.getPaths(),g);b.setPoints(h),b.setDistance(e),$.isFunction(a)&&a.call(this);for(var i=1e3*$("select[name=route_deviation]").val(),j=[],k=[],l=[],m=[],n=b.mode_center,o=0;o<h.length-1;o++)if(h[o]&&h[o+1]){n=b.mode_center,0==o&&(n=b.mode_first),o==h.length-2&&(n=b.mode_last);var p=ListingMap.getOrthoPoints(h[o],h[o+1],i,n);j.push(p[0]),k.push(p[1]),0==o&&(l=b.calculateEndCircles(p[0],p[1])),o==h.length-2&&(m=b.calculateEndCircles(p[1],p[0]))}var q=[];for(o=0;o<j.length;o++)q.push(j[o]);for(o=0;o<m.length;o++)q.push(m[o]);for(o=k.length-1;o>=0;o--)q.push(k[o]);for(o=0;o<l.length;o++)q.push(l[o]);var r=new ymaps.Polygon([q],{},{fillColor:"#69c",opacity:.4});b.map.geoObjects.add(r),b.map.setBounds(b.map.geoObjects.getBounds()),b.geo_area=r,b.loading(0)},function(d){b.driveDirectLine(c,a),b.loading(0)}),!0):(b.clearPoints(),c.from?alert("Не выбран пункт выгрузки!"):alert("Не выбран пункт погрузки!"),!1)},driveDirectLine:function(a,b){var c=null,d=null,e=function(){c&&d&&(ListingMap.setPoints([c,d]),$.isFunction(b)&&b.call(this),ListingMap.map.geoObjects.add(new ymaps.Placemark(c,{hintContent:a.from},{iconImageHref:"/assets/images/v2/map/A.png",iconImageSize:[43,48]})),ListingMap.map.geoObjects.add(new ymaps.Placemark(d,{hintContent:a.to},{iconImageHref:"/assets/images/v2/map/B.png",iconImageSize:[43,48]})),ListingMap.map.geoObjects.add(new ymaps.GeoObject({geometry:{type:"LineString",coordinates:[c,d]}})))};ymaps.geocode(a.from).then(function(a){if(a&&a.geoObjects){var b=a.geoObjects.get(0);b&&(c=b.geometry.getCoordinates(),e())}}),ymaps.geocode(a.to).then(function(a){if(a&&a.geoObjects){var b=a.geoObjects.get(0);b&&(d=b.geometry.getCoordinates(),e())}})},getOrthoPoints:function(a,b,c,d){var e=Math.atan2(b[0]-a[0],b[1]-a[1]),f=e-Math.PI/2,g=e+Math.PI/2,h=[0,0];d&&d!=this.mode_center?d==this.mode_last?h=[b[0],b[1]]:d==this.mode_first&&(h=[a[0],a[1]]):h=[(b[0]+a[0])/2,(b[1]+a[1])/2];var i=ymaps.coordSystem.geo.solveDirectProblem(h,[Math.sin(f),Math.cos(f)],c),j=ymaps.coordSystem.geo.solveDirectProblem(h,[Math.sin(g),Math.cos(g)],c);return[i.endPoint,j.endPoint]},calculateEndCircles:function(a,b){for(var c=[(b[0]+a[0])/2,(b[1]+a[1])/2],d=Math.atan2(b[0]-a[0],b[1]-a[1]),e=lib.utils.distance(a[0],a[1],b[0],b[1])/2,f=[d+Math.PI/3,d+Math.PI/2,d+2*Math.PI/3],g=[],h=0;h<f.length;h++)g.push(ymaps.coordSystem.geo.solveDirectProblem(c,[Math.sin(f[h]),Math.cos(f[h])],e).endPoint);return g},clusterInformerShow:function(a,b){$("#loading").html(a),$("#unloading").html(b),$("#cluster_informer").show(),this.cluster_informer_timer&&clearTimeout(this.cluster_informer_timer)},clusterInformerHide:function(){$("#cluster_informer").hide()},loading:function(a){a?$(".loading").show():$(".loading").hide()},setPoints:function(a){$("#route_points").val(JSON.stringify(a))},setDistance:function(a){$("#route_distance_m").val(a)},clearPoints:function(){$("#route_points").val("")},enable:function(){$(".map_container").show(),$("select[name=origin_deviation], select[name=route_deviation], input[name=show_back_cargos]").closest("div.row").show(),$("#is_map").val(1),this._enable=1,$("#x-listing-search-form").submit()},disable:function(){$(".map_container").hide(),$("select[name=origin_deviation], select[name=route_deviation], input[name=show_back_cargos]").closest("div.row").hide(),$("#is_map").val(0),this.clear(),this.clearPoints(),this._enable=0},saveSearch:function(){},loadSearch:function(){},Districts:{1:{lat:54.749646,lng:37.62368,title:"Центральный федеральный округ"},2:{lat:46.261008,lng:39.628,title:"Южный федеральный округ"},3:{lat:58.90802,lng:30.409998,title:"Северо-Западный федеральный округ"},4:{lat:47.50973,lng:135.072501,title:"Дальневосточный федеральный округ"},5:{lat:54.018804,lng:82.933949,title:"Сибирский федеральный округ"},6:{lat:55.839196,lng:60.62595,title:"Уральский федеральный округ"},7:{lat:55.29274,lng:43.926745,title:"Приволжский федеральный округ"},8:{lat:43.053294,lng:43.040601,title:"Северо-Кавказский федеральный округ"}},Regions:{1:{lat:44.8229155,lng:40.1754463,district:2},2:{lat:54.2312172,lng:56.1645257,district:7},3:{lat:54.8331146,lng:112.4060529,district:5},4:{lat:50.6181924,lng:86.2199308,district:5},5:{lat:42.1431886,lng:47.0949799,district:8},6:{lat:43.4051698,lng:44.8202999,district:8},7:{lat:43.3932469,lng:43.5628498,district:8},8:{lat:46.5676845,lng:45.7731614,district:2},9:{lat:43.8845143,lng:41.730394,district:8},10:{lat:63.1558702,lng:32.9905552,district:3},11:{lat:63.8630539,lng:54.8312689,district:3},12:{lat:56.438457,lng:47.9607757,
district:7},13:{lat:54.2369441,lng:44.0683969,district:7},14:{lat:66.7613451,lng:124.1237531,district:4},15:{lat:43.0451302,lng:44.2870972,district:8},16:{lat:55.1802364,lng:50.7263945,district:7},17:{lat:51.8872669,lng:95.6260172,district:5},18:{lat:57.0670218,lng:53.0277948,district:7},19:{lat:53.0452281,lng:90.3982145,district:5},20:{lat:43.4023301,lng:45.7187468,district:8},21:{lat:55.5595992,lng:46.9283536,district:7},22:{lat:51.7936298,lng:82.6758596,district:5},23:{lat:45.6415289,lng:39.7055977,district:2},24:{lat:64.2479758,lng:95.1104176,district:5},25:{lat:45.0525641,lng:135,district:4},26:{lat:44.6680993,lng:43.520214,district:8},27:{lat:50.5888431,lng:135,district:4},28:{lat:54.6035065,lng:127.4801721,district:4},29:{lat:63.2852803,lng:42.5884191,district:3},30:{lat:46.1321166,lng:48.0610115,district:2},31:{lat:50.7106926,lng:37.7533377,district:1},32:{lat:53.0408599,lng:33.2690899,district:1},33:{lat:56.1553465,lng:40.5926685,district:1},34:{lat:49.7604522,lng:45,district:2},35:{lat:59.8706711,lng:40.6555411,district:3},36:{lat:50.8589713,lng:39.8644375,district:1},37:{lat:57.1056854,lng:41.4830084,district:1},38:{lat:56.132142,lng:103.948625,district:5},39:{lat:54.8235292,lng:21.4816163,district:3},40:{lat:54.3872666,lng:35.1889094,district:1},41:{lat:61.4343981,lng:166.7884131,district:4},42:{lat:54.7574648,lng:87.4055288,district:5},43:{lat:58.4198529,lng:50.2097248,district:7},44:{lat:58.5501069,lng:43.9541103,district:1},45:{lat:55.4481548,lng:65.11809749,district:6},46:{lat:51.7634026,lng:35.3811812,district:0},47:{lat:60.0793208,lng:31.8926644,district:1},48:{lat:52.5264702,lng:39.2032269,district:1},49:{lat:62.6643417,lng:153.9149909,district:4},50:{lat:55.340396,lng:38.2917651,district:1},51:{lat:67.8442674,lng:35.0884101,district:3},52:{lat:55.7995159,lng:44.0296769,district:7},53:{lat:58.2427552,lng:32.5665191,district:3},54:{lat:55.4467133,lng:80.1043924,district:5},55:{lat:55.0554669,lng:73.3167343,district:5},56:{lat:51.7634026,lng:54.6188188,district:7},57:{lat:52.7450189,lng:36.4849627,district:1},58:{lat:53.1412105,lng:44.0940048,district:7},59:{lat:58.8231929,lng:56.5872481,district:7},60:{lat:56.7708599,lng:29.094009,district:3},61:{lat:47.6853247,lng:41.8258952,district:2},62:{lat:54.3875964,lng:41.259566,district:1},63:{lat:53.4183839,lng:50.4725528,district:7},64:{lat:51.8369263,lng:46.7539397,district:7},65:{lat:49.9807847,lng:143.3738129,district:4},66:{lat:59.007735,lng:61.9316226,district:6},67:{lat:54.9882994,lng:32.6677378,district:1},68:{lat:52.6416589,lng:41.4216451,district:1},69:{lat:57.0021654,lng:33.9853142,district:1},70:{lat:58.8969882,lng:82.67655,district:5},71:{lat:54.163768,lng:37.5649507,district:1},72:{lat:56.9634387,lng:66.948278,district:6},73:{lat:53.9793357,lng:47.7762426,district:7},74:{lat:54.4319422,lng:60.8788963,district:6},75:{lat:53.0928771,lng:116.967656,district:5},76:{lat:57.8991523,lng:38.8388633,district:1},77:{lat:55.749646,lng:37.62368,district:1},78:{lat:59.90802,lng:30.4099,district:3},79:{lat:48.4808147,lng:131.7657367,district:4},83:{lat:67.6078337,lng:57.6338331,district:3},86:{lat:62.2287062,lng:70.6410058,district:6},87:{lat:65.6298355,lng:171.6952159,district:4},89:{lat:66.0653057,lng:76.9345194,district:6},99:{lat:45.628231,lng:63.304562,district:0}},RegionCapitals:{1:{lat:44.605194,"long":40.103567},2:{lat:54.809866,"long":56.093911},3:{lat:51.836725,"long":107.585865},4:{lat:51.963723,"long":85.922229},5:{lat:42.988836,"long":47.489188},6:{lat:43.173639,"long":44.805529},7:{lat:43.481834,"long":43.602656},8:{lat:46.308501,"long":44.254297},9:{lat:44.238301,"long":42.061785},10:{lat:61.788863,"long":34.359724},11:{lat:61.660824,"long":50.833217},12:{lat:56.635033,"long":47.89974},13:{lat:54.189881,"long":45.172246},14:{lat:62.022957,"long":129.717095},15:{lat:43.034798,"long":44.679798},16:{lat:55.824874,"long":49.086087},17:{lat:51.706925,"long":94.406401},18:{lat:56.863809,"long":53.2281},19:{lat:53.712524,"long":91.420606},20:{lat:43.315249,"long":45.696028},21:{lat:56.104219,"long":47.259418},22:{lat:53.33324,"long":83.667235},23:{lat:45.053548,"long":39.016056},24:{lat:56.010221,"long":92.871949},25:{lat:43.136517,"long":131.911079},26:{lat:45.045023,"long":41.996087},27:{lat:48.50973,"long":135.072501},28:{lat:50.291167,"long":127.527094},29:{lat:64.538518,"long":40.514856},30:{lat:46.333818,"long":48.021857},31:{lat:50.569269,"long":36.589625},32:{lat:53.232251,"long":34.360264},33:{lat:56.137661,"long":40.41348},34:{lat:48.711923,"long":44.491084},35:{lat:59.218573,"long":39.89102},36:{lat:51.656,"long":39.187558},37:!1,38:!1,39:{lat:54.711609,"long":20.46453},40:{lat:54.535573,"long":36.248694},41:{lat:53.018881,"long":158.663566},42:{lat:55.353175,"long":86.064448},43:{lat:58.648849,"long":49.706256},44:{lat:57.771284,"long":40.950603},45:{lat:55.449322,"long":65.314686},46:{lat:51.722692,"long":36.177071},47:{lat:59.936504,"long":31.035722},48:{lat:52.60148,"long":39.584089},49:!1,50:{lat:55.291731,"long":38.727426},51:{lat:68.976167,"long":33.094409},52:{lat:56.29274,"long":43.926745},53:{lat:58.536742,"long":31.271227},54:{lat:55.018804,"long":82.933949},55:{lat:54.99118,"long":73.370253},56:{lat:51.771087,"long":55.098056},57:{lat:52.971522,"long":36.087718},58:{lat:53.250585,"long":45.016555},59:{lat:58.001985,"long":56.257287},60:!1,61:{lat:47.261008,"long":39.628},62:{lat:54.615072,"long":39.693268},63:{lat:53.260908,"long":50.198077},64:{lat:51.534272,"long":46.01014},65:{lat:46.965022,"long":142.739092},66:{lat:56.839196,"long":60.62595},67:{lat:54.810121,"long":32.041799},68:{lat:52.726659,"long":41.386226},69:{lat:56.859633,"long":35.88947},70:{lat:56.469111,"long":84.967192},71:{lat:54.184814,"long":37.627447},73:{lat:54.307799,"long":48.338941},74:{lat:55.152009,"long":61.40857},75:{lat:52.0337,"long":113.499661},76:{lat:57.633568,"long":39.879512},77:{lat:55.749646,"long":37.62368},78:{lat:59.90802,"long":30.409998},79:{lat:48.787167,"long":132.932367},80:{lat:67.637636,"long":53.015613},81:!1,82:{lat:64.727191,"long":177.502146},83:{lat:66.5333333,"long":66.6}},RegionTitles:{1:"Республика Адыгея",2:"Республика Башкортостан",3:"Республика Бурятия",4:"Республика Алтай",5:"Республика Дагестан",6:"Республика Ингушетия",7:"Кабардино-Балкарская Республика",8:"Республика Калмыкия",9:"Карачаево-Черкесская Республика",10:"Республика Карелия",11:"Республика Коми",12:"Республика Марий Эл",13:"Республика Мордовия",14:"Республика Саха (Якутия)",15:"Республика Северная Осетия - Алания",16:"Республика Татарстан",17:"Республика Тыва",18:"Удмуртская Республика",19:"Республика Хакасия",20:"Чеченская Республика",21:"Чувашская Республика",22:"Алтайский край",23:"Краснодарский край",24:"Красноярский край",25:"Приморский край",26:"Ставропольский край",27:"Хабаровский край",28:"Амурская область",29:"Архангельская область",30:"Астраханская область",31:"Белгородская область",32:"Брянская область",33:"Владимирская область",34:"Волгоградская область",35:"Вологодская область",36:"Воронежская область",37:"Ивановская область",38:"Иркутская область",39:"Калининградская область",40:"Калужская область",41:"Камчатский край",42:"Кемеровская область",43:"Кировская область",44:"Костромская область",45:"Курганская область",46:"Курская область",47:"Ленинградская область",48:"Липецкая область",49:"Магаданская область",50:"Московская область",51:"Мурманская область",52:"Нижегородская область",53:"Новгородская область",54:"Новосибирская область",55:"Омская область",56:"Оренбургская область",57:"Орловская область",58:"Пензенская область",59:"Пермский край",60:"Псковская область",61:"Ростовская область",62:"Рязанская область",63:"Самарская область",64:"Саратовская область",65:"Сахалинская область",66:"Свердловская область",67:"Смоленская область",68:"Тамбовская область",69:"Тверская область",70:"Томская область",71:"Тульская область",72:"Тюменская область",73:"Ульяновская область",74:"Челябинская область",75:"Забайкальский край",76:"Ярославская область",77:"Москва",78:"Санкт-Петербург",79:"Еврейская автономная область",83:"Ненецкий автономный округ",86:"ХМАО",87:"Чукотский автономный округ",89:"Ямало-Ненецкий автономный округ",99:"Байконур"},Countries:{1:["Россия",61.524,105.319],2:["США",37.09,-95.713],3:["Украина",48.379,31.166],4:["Великобритания",55.378,-3.436],5:["Казахстан",48.02,66.924],6:["Япония",36.205,138.253],7:["Польша",51.919,19.145],8:["Германия",51.166,10.452],9:["Индия",20.594,78.963],10:["Белоруссия",53.71,27.953],11:["Мексика",23.635,-102.553],12:["Франция",46.228,2.214],13:["Бразилия",-14.235,-51.925],14:["Канада",56.13,-106.347],15:["Узбекистан",41.377,64.585],16:["Италия",41.872,12.567],17:["Литва",55.169,23.881],18:["Киргизия",41.204,74.766],19:["Азербайджан",40.143,47.577],20:["Грузия",42.315,43.357],21:["Таджикистан",38.861,71.276],22:["Испания",40.464,-3.749],23:["Латвия",56.88,24.603],24:["Израиль",31.046,34.852],26:["Австралия",-25.274,133.775],27:["Аргентина",-38.416,-63.617],28:["Молдавия",47.412,28.37],29:["Болгария",42.734,25.486],30:["Китай",35.862,104.195],31:["Нидерланды",52.133,5.291],32:["Турция",38.964,35.243],33:["Эстония",58.595,25.014],34:["Венгрия",47.162,19.503],35:["Южная Корея",35.908,127.767],36:["Швеция",60.128,18.644],38:["Румыния",45.943,24.967],39:["Австрия",47.516,14.55],40:["Чехия",47.516,14.55],41:["Финляндия",61.924,25.748],42:["Югославия",25.785,-100.248],43:["Швейцария",46.818,8.228],44:["Бельгия",50.504,4.47],45:["Иран",32.428,53.688],46:["Вьетнам",14.058,108.277],47:["Норвегия",60.472,8.469],48:["Греция",39.074,21.824],49:["Португалия",39.4,-8.224],50:["Сальвадор",13.794,-88.897],51:["Египет",26.821,30.802],52:["Дания",56.264,9.502],53:["Хорватия",45.1,15.2],54:["Нидерланды",52.133,5.291],57:["Армения",40.069,45.038],58:["Ирландия",53.413,-8.244],59:["Коста-Рика",9.749,-83.753],60:["Кипр",35.126,33.43],61:["Камерун",7.37,12.355],62:["Словения",46.151,14.995],63:["Мозамбик",-18.666,35.53],64:["Туркмения",38.97,59.556],65:["Ирак",33.223,43.679],66:["Пакистан",30.375,69.345],67:["Словакия",48.669,19.699],69:["Уганда",1.373,32.29],70:["Марокко",31.792,-7.093],72:["Ливия",26.335,17.228],73:["Монако",43.738,7.425],74:["Корея",44.401,-67.975],75:["Кувейт",29.312,47.482],76:["Ливан",33.855,35.862],77:["Тёркс и Кайкос",21.694,-71.798],78:["Белиз",17.19,-88.498],79:["Бермуды",32.308,-64.751],80:["Гондурас",15.2,-86.242],81:["Гонконг",22.396,114.109],83:["Люксембург",49.612,6.132],84:["Доминикана",-27.476,-58.811],85:["Тайвань",23.698,120.961],87:["Сирия",34.802,38.997],88:["Таиланд",15.87,100.993],89:["Тунис",33.887,9.537],91:["ЮАР",-30.559,22.938],92:["Эквадор",-1.831,-78.183],93:["Чили",-35.675,-71.543],94:["Сингапур",1.352,103.82],95:["Реюньон",-21.115,55.536],96:["Куба",21.522,-77.781],98:["Иордания",30.585,36.238],99:["Индонезия",-.789,113.921],100:["Македония",41.609,21.745],101:["Малайзия",4.21,101.976],102:["Перу",-9.19,-75.015],103:["О.А.Э.",24.24,54.66],104:["Монголия",46.862,103.847],105:["Мальта",35.937,14.375]},MultyWindow:'<div class="m-vip"><a href="#" class="m-close"></a><p>В этой точке находится несколько погрузок или выгрузок.</p><button id="show_multy_results" class="m-but2">Посмотреть грузы в этой точке</button></div>'};$(document).ready(function(){$(".x-listing-navigation").vvListingNav(),$(".x-listing-box").vvListingBox(),$(".x-listing-box.x-box-order-id").vvListingBoxOrderId(),$(".x-listing-box.x-box-config").vvListingBoxConfig(),$(".x-listing-box.x-box-category").vvListingBoxCategory(),$(".x-listing-box.x-box-route").vvListingBoxRoute(),$(".x-listing-box.x-box-origin").vvListingBoxOrigin(),$("#x-box-listing-tmp-select").vvListingBoxTmp(),$(".x-listing-box.x-box-weight").vvListingBoxWeight(),$(".x-listing-box.x-box-trunk").vvListingBoxTrunks(),$(".x-ac").vvAutocomplete(),$(".x-listing").vvListing(),$(".x-listing-filter").vvListingFilter(),$(document).on("mouseenter",".x-order-rows",function(){$(".x-order-row-right",this).animate({right:"-=10"},150)}),$(document).on("mouseleave",".x-order-rows",function(){$(".x-order-row-right",this).animate({right:"+=10"},150)}),$(document).on("click","a.x-reset-no-result",function(){$(".x-listing-filter").vvListingFilterReset()})}),"undefined"!=typeof ymaps&&ymaps.ready(function(){ListingMap.init()});var helper={parseGetParams:function(){for(var a={},b=window.location.search.substring(1).split("&"),c=0;c<b.length;c++){var d=b[c].split("=");a[d[0]]="undefined"==typeof d[1]?"":d[1]}return a}},$_GET=helper.parseGetParams();